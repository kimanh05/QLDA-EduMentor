<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>EduMentor Demo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    /* ========== RESET ========== */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        sans-serif;
    }
    body {
      background: #f5f5f7;
      color: #333;
    }
    a {
      text-decoration: none;
      color: inherit;
    }
    button {
      cursor: pointer;
      border: none;
      outline: none;
      font: inherit;
    }

    /* ========== COLORS (BLUE THEME) ========== */
    :root {
      --primary: #0a4a7a;        /* xanh ƒë·∫≠m */
      --primary-dark: #00325a;   /* xanh navy */
      --primary-light: #ddefff;  /* xanh nh·∫°t */
      --accent: #1f77b3;         /* xanh trung b√¨nh */
      --gray-light: #f8f8fa;
      --gray-border: #e1e1e8;
      --text-main: #172b4d;
      --status-green-bg: #e6ffed;
      --status-green-text: #218639;
      --status-red-bg: #ffe6e6;
      --status-red-text: #cc1f1a;
      --status-wait-bg: #fff7e6;
      --status-wait-text: #b76a00;
    }

    .container {
      max-width: 1100px;
      margin: 0 auto;
      padding: 0 16px;
    }

    /* ========== NAVBAR ========== */
    .navbar {
      background: #ffffff;
      box-shadow: 0 2px 8px rgba(15, 35, 52, 0.08);
      padding: 8px 0;
      position: sticky;
      top: 0;
      z-index: 20;
    }
    .navbar-inner {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
    }
    .nav-left {
      display: flex;
      align-items: center;
      gap: 10px;
      min-width: 0;
    }

    /* LOGO: m√¥ ph·ªèng logo EduMentor xanh */
    .logo-wrapper {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .logo-circle {
      width: 34px;
      height: 34px;
      border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, #ffffff 5%, #1f77b3 40%, #0a4a7a 70%);
      position: relative;
      overflow: visible;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);
      flex-shrink: 0;
    }
    /* v√≤ng tr√≤n trong */
    .logo-circle::before {
      content: "";
      position: absolute;
      inset: 8px;
      border-radius: 50%;
      border: 3px solid #ffffff;
    }
    /* m≈© t·ªët nghi·ªáp */
    .logo-circle::after {
      content: "";
      position: absolute;
      width: 22px;
      height: 14px;
      background: #0a4a7a;
      top: -8px;
      left: 50%;
      transform: translateX(-55%) skewX(-8deg);
      border-radius: 3px 3px 1px 1px;
      box-shadow: 0 1px 0 rgba(0, 0, 0, 0.18);
    }
    .logo-text {
      font-weight: 800;
      letter-spacing: 0.03em;
      color: #0a4a7a;
      font-size: 20px;
      white-space: nowrap;
    }

    .nav-pages {
      margin-left: 24px;
      display: flex;
      gap: 12px;
      font-size: 13px;
      flex-wrap: wrap;
    }
    .nav-pages button {
      background: transparent;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid transparent;
      color: #4a5568;
      white-space: nowrap;
    }
    .nav-pages button.active {
      border-color: var(--accent);
      color: var(--accent);
      background: #edf6ff;
    }

    .nav-right {
      display: flex;
      flex-direction: column;
      align-items: flex-end;
      gap: 4px;
    }
    .nav-note {
      font-size: 11px;
      color: #4a5568;
      max-width: 260px;
      text-align: right;
      line-height: 1.3;
    }
    .nav-right-bottom {
      display: flex;
      align-items: center;
      gap: 8px;
      flex-wrap: wrap;
      justify-content: flex-end;
    }

    .btn {
      padding: 8px 18px;
      border-radius: 20px;
      font-weight: 600;
      font-size: 14px;
      transition: 0.2s all;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }
    .btn-outline {
      border: 1px solid var(--accent);
      color: var(--accent);
      background: transparent;
    }
    .btn-outline:hover {
      background: #edf6ff;
    }
    .btn-primary {
      background: var(--accent);
      color: #fff;
    }
    .btn-primary:hover {
      background: var(--primary-dark);
    }
    .btn-icon {
      font-size: 16px;
    }
    .btn-xs {
      padding: 4px 10px;
      font-size: 12px;
      border-radius: 999px;
    }

    .user-pill {
      padding: 6px 12px;
      border-radius: 999px;
      background: #edf6ff;
      color: var(--primary);
      font-size: 13px;
      font-weight: 600;
    }

    section {
      padding: 32px 0 40px;
    }
    .section-title {
      text-align: center;
      font-size: 28px;
      color: var(--primary);
      font-weight: 800;
      margin-bottom: 10px;
    }
    .section-subtitle {
      text-align: center;
      max-width: 700px;
      margin: 0 auto 26px;
      line-height: 1.5;
      color: #4a5568;
    }

    /* HERO */
    .hero {
      padding-top: 40px;
    }
    .hero-grid {
      display: grid;
      grid-template-columns: 1.2fr 1fr;
      gap: 24px;
      align-items: center;
    }
    @media (max-width: 880px) {
      .hero-grid {
        grid-template-columns: 1fr;
      }
    }
    .hero h1 {
      font-size: 30px;
      color: var(--primary-dark);
      margin-bottom: 12px;
      letter-spacing: 0.03em;
      text-transform: none;
    }
    .hero-text {
      font-size: 14px;
      color: #4a5568;
      line-height: 1.6;
      margin-bottom: 12px;
    }
    .hero-cta-row {
      display: flex;
      gap: 10px;
      margin-top: 6px;
      flex-wrap: wrap;
    }
    .hero-badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 12px;
      background: #ffffff;
      color: #4a5568;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid #e2e8f0;
      margin-top: 10px;
    }
    .hero-image-wrapper {
      position: relative;
      border-radius: 24px;
      overflow: hidden;
      box-shadow: 0 18px 40px rgba(15, 35, 52, 0.35);
      background: #000;
      min-height: 230px;
    }
    .hero-image {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
      filter: saturate(1.08);
    }
    .hero-image-tag {
      position: absolute;
      left: 16px;
      bottom: 16px;
      background: rgba(10, 74, 122, 0.9);
      color: #fff;
      padding: 6px 10px;
      font-size: 12px;
      border-radius: 999px;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .cards-grid {
      margin-top: 24px;
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 18px;
    }
    @media (max-width: 900px) {
      .cards-grid { grid-template-columns: repeat(2, minmax(0, 1fr)); }
    }
    @media (max-width: 640px) {
      .cards-grid { grid-template-columns: 1fr; }
    }
    .card {
      background: #fff;
      border-radius: 16px;
      padding: 20px 22px;
      box-shadow: 0 4px 14px rgba(15, 35, 52, 0.08);
      border: 1px solid #e2ecff;
    }
    .card-icon {
      width: 44px;
      height: 44px;
      border-radius: 50%;
      background: var(--primary-light);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      color: var(--primary);
      margin-bottom: 10px;
    }
    .card-title {
      font-weight: 700;
      margin-bottom: 4px;
      color: var(--text-main);
    }
    .card-text {
      font-size: 14px;
      color: #4a5568;
      line-height: 1.5;
    }

    .how-section {
      margin-top: 32px;
    }
    .how-cards {
      margin-top: 18px;
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 18px;
    }
    @media (max-width: 900px) {
      .how-cards { grid-template-columns: repeat(2, minmax(0, 1fr)); }
    }
    @media (max-width: 640px) {
      .how-cards { grid-template-columns: 1fr; }
    }

    /* FOOTER */
    footer {
      background: #ffffff;
      padding: 26px 0 14px;
      border-top: 1px solid #e2e8f0;
    }
    .footer-top {
      display: grid;
      grid-template-columns: 2fr 1.5fr 1.5fr;
      gap: 20px;
      font-size: 14px;
      margin-bottom: 16px;
      color: #4a5568;
    }
    @media (max-width: 800px) {
      .footer-top { grid-template-columns: 1fr; }
    }
    .footer-title {
      font-weight: 700;
      margin-bottom: 6px;
      color: var(--primary);
      text-transform: uppercase;
      font-size: 13px;
    }
    .footer-links a {
      display: block;
      margin-bottom: 4px;
      font-size: 14px;
      color: #4a5568;
    }
    .footer-bottom {
      text-align: center;
      font-size: 12px;
      color: #718096;
      border-top: 1px solid #e2e8f0;
      padding-top: 10px;
    }
    .social-row {
      display: flex;
      gap: 8px;
      margin-top: 8px;
      font-size: 18px;
    }

    /* GENERAL */
    .hidden { display: none !important; }

    .page-title {
      text-align: center;
      color: var(--primary);
      font-size: 24px;
      font-weight: 800;
      margin-bottom: 20px;
    }

    .muted { color: #777; font-size: 14px; text-align: center; }

    /* CLASS CARDS */
    .class-card {
      background: #fff;
      border-radius: 16px;
      padding: 18px 22px;
      margin-bottom: 16px;
      display: flex;
      flex-direction: column;
      box-shadow: 0 4px 14px rgba(15, 35, 52, 0.08);
      gap: 12px;
      border: 1px solid #e2ecff;
    }
    .class-top-row {
      display: flex;
      align-items: flex-start;
      gap: 12px;
    }
    .avatar-circle {
      width: 46px;
      height: 46px;
      border-radius: 50%;
      background: #a6c9e2;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      color: #ffffff;
      flex-shrink: 0;
      text-transform: uppercase;
    }
    .class-main { flex: 1; }
    .class-name {
      font-weight: 700;
      margin-bottom: 2px;
      color: var(--text-main);
    }
    .class-subtitle {
      font-size: 14px;
      color: #4a5568;
    }
    .class-info-grid {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 8px 16px;
      margin-top: 10px;
      font-size: 13px;
      color: #4a5568;
    }
    @media (max-width: 800px) {
      .class-info-grid { grid-template-columns: repeat(2, minmax(0, 1fr)); }
    }
    @media (max-width: 600px) {
      .class-info-grid { grid-template-columns: 1fr; }
    }
    .info-item {
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .info-icon { font-size: 14px; }
    .class-bottom-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 8px;
      font-size: 14px;
      gap: 8px;
      flex-wrap: wrap;
    }
    .phone-link {
      font-weight: 600;
      color: var(--accent);
    }
    .class-actions {
      display: flex;
      gap: 8px;
      align-items: center;
      flex-wrap: wrap;
      justify-content: flex-end;
    }

    .status-pill {
      padding: 5px 12px;
      border-radius: 999px;
      font-size: 12px;
      font-weight: 600;
    }
    .status-wait {
      background: var(--status-wait-bg);
      color: var(--status-wait-text);
    }
    .status-accepted {
      background: var(--status-green-bg);
      color: var(--status-green-text);
    }
    .status-rejected {
      background: var(--status-red-bg);
      color: var(--status-red-text);
    }
    .status-connected {
      background: var(--status-green-bg);
      color: var(--status-green-text);
    }

    /* PROFILE */
    .profile-card {
      background: #fff;
      border-radius: 16px;
      padding: 20px 24px;
      margin-bottom: 22px;
      display: flex;
      gap: 24px;
      align-items: flex-start;
      box-shadow: 0 4px 14px rgba(15, 35, 52, 0.08);
      border: 1px solid #e2ecff;
    }
    .profile-avatar {
      width: 90px;
      height: 90px;
      border-radius: 999px;
      background: linear-gradient(135deg, #0a4a7a, #1f77b3);
      display: flex;
      align-items: center;
      justify-content: center;
      color: #fff;
      font-size: 40px;
      flex-shrink: 0;
      text-transform: uppercase;
      overflow: hidden;
    }
    .profile-avatar img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }
    .profile-main {
      flex: 1;
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      column-gap: 30px;
      row-gap: 6px;
      font-size: 14px;
    }
    .profile-main strong { margin-right: 4px; }
    .profile-header {
      display: flex;
      justify-content: space-between;
      margin-bottom: 10px;
      align-items: center;
    }
    .profile-name {
      font-weight: 800;
      font-size: 18px;
      color: var(--primary);
    }
    .rating-badge {
      padding: 6px 12px;
      background: #edf6ff;
      border-radius: 999px;
      color: var(--primary);
      font-size: 13px;
      font-weight: 600;
      margin-top: 8px;
      display: inline-block;
    }
    .rating-list {
      margin-top: 10px;
      font-size: 13px;
      color: #4a5568;
    }
    .rating-item {
      padding: 6px 10px;
      border-radius: 8px;
      background: #f1f5ff;
      margin-bottom: 6px;
    }

    /* MODAL */
    .modal-backdrop {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.35);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 30;
      backdrop-filter: blur(3px);
      padding: 16px;
    }
    .modal {
      background: #fff;
      border-radius: 16px;
      max-width: 420px;
      width: 100%;
      padding: 24px 24px 22px;
      box-shadow: 0 8px 30px rgba(15, 35, 52, 0.4);
      position: relative;
      border: 1px solid #e2ecff;
    }
    .modal-title {
      text-align: center;
      font-weight: 800;
      font-size: 20px;
      margin-bottom: 18px;
      color: var(--primary);
    }
    .modal-close {
      position: absolute;
      top: 12px;
      right: 16px;
      background: transparent;
      font-size: 18px;
      color: #a0aec0;
    }
    .modal-tabs {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 8px;
      margin-bottom: 16px;
    }
    .modal-tab {
      padding: 10px;
      border-radius: 30px;
      border: 1px solid var(--accent);
      background: #fff;
      color: var(--accent);
      font-size: 14px;
      text-align: center;
    }
    .modal-tab.active {
      background: var(--accent);
      color: #fff;
    }

    .form-group {
      margin-bottom: 12px;
    }
    label {
      display: block;
      font-size: 13px;
      margin-bottom: 4px;
      color: #4a5568;
    }
    .input {
      width: 100%;
      border-radius: 24px;
      border: 1px solid #cbd5e0;
      padding: 8px 14px;
      font-size: 14px;
      outline: none;
      transition: border-color 0.15s, background-color 0.15s;
      background: #f7fafc;
    }
    .input:focus {
      border-color: var(--accent);
      background: #ffffff;
    }
    .password-wrapper { position: relative; }
    .toggle-password {
      position: absolute;
      right: 14px;
      top: 50%;
      transform: translateY(-50%);
      font-size: 16px;
      color: #a0aec0;
      background: transparent;
    }
    .select {
      width: 100%;
      border-radius: 24px;
      border: 1px solid #cbd5e0;
      padding: 8px 14px;
      font-size: 14px;
      background: #f7fafc;
      outline: none;
    }
    .modal-footer-text {
      text-align: center;
      font-size: 13px;
      margin-top: 10px;
    }
    .modal-footer-text a {
      color: var(--accent);
      font-weight: 600;
    }

    /* PARENT POSTS: applicant list */
    .applicants-toggle {
      font-size: 13px;
      color: var(--accent);
      font-weight: 600;
      cursor: pointer;
    }
    .applicants-list {
      margin-top: 10px;
      border-top: 1px solid #e2e8f0;
      padding-top: 10px;
    }
    .applicant-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 8px 10px;
      border-radius: 8px;
      background: #f1f5ff;
      margin-bottom: 6px;
      font-size: 14px;
    }
    .applicant-left {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .applicant-avatar {
      width: 26px;
      height: 26px;
      border-radius: 999px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #a6c9e2;
      color: #fff;
      font-size: 14px;
      text-transform: uppercase;
    }
    .applicant-accepted {
      background: #e6ffed;
      color: var(--status-green-text);
    }

    /* CREATE POST FORM */
    .card-form {
      max-width: 700px;
      margin: 0 auto;
      background: #fff;
      border-radius: 16px;
      padding: 22px 24px 24px;
      box-shadow: 0 4px 14px rgba(15, 35, 52, 0.08);
      border: 1px solid #e2ecff;
    }
    .form-grid-2 {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 10px 14px;
    }
    @media (max-width: 720px) {
      .form-grid-2 { grid-template-columns: 1fr; }
    }

    /* PAYMENT MODAL */
    .qr-options {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 12px;
      margin-bottom: 14px;
    }
    @media (max-width: 520px) {
      .qr-options { grid-template-columns: 1fr; }
    }
    .qr-card {
      border-radius: 12px;
      border: 1px solid #e2e8f0;
      padding: 10px 12px;
      background: #f7fafc;
      font-size: 13px;
    }
    .qr-title {
      font-weight: 700;
      color: var(--primary);
      margin-bottom: 4px;
      font-size: 14px;
    }
    .qr-box {
      margin-top: 8px;
      width: 100%;
      aspect-ratio: 1 / 1;
      border-radius: 8px;
      border: 2px dashed #cbd5e0;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 13px;
      color: #4a5568;
      background: repeating-linear-gradient(
        45deg,
        #f9fafb,
        #f9fafb 6px,
        #ddefff 6px,
        #ddefff 12px
      );
    }
    .qr-note {
      font-size: 12px;
      color: #718096;
      margin-top: 4px;
    }

    /* QUIZ */
    .quiz-card {
      max-width: 800px;
      margin: 0 auto;
      background: #fff;
      border-radius: 16px;
      padding: 20px 24px 24px;
      box-shadow: 0 4px 14px rgba(15, 35, 52, 0.08);
      border: 1px solid #e2ecff;
      font-size: 14px;
      color: #2d3748;
    }
    .quiz-status {
      font-size: 13px;
      margin-bottom: 6px;
    }
    .quiz-note {
      font-size: 13px;
      margin-bottom: 12px;
      color: #4a5568;
    }
    .quiz-question {
      margin-bottom: 10px;
      padding: 10px 12px;
      border-radius: 10px;
      background: #f7fafc;
    }
    .quiz-question-title {
      margin-bottom: 6px;
      font-weight: 600;
    }
    .quiz-options label {
      display: block;
      margin-bottom: 3px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <!-- NAVBAR -->
  <header class="navbar">
    <div class="container navbar-inner">
      <div class="nav-left">
        <div class="logo-wrapper">
          <div class="logo-circle"></div>
          <div class="logo-text">EduMentor</div>
        </div>

        <div class="nav-pages">
          <button class="nav-page-btn active" data-target="home-section">Trang ch·ªß</button>
          <button class="nav-page-btn" data-target="classes-section">Danh s√°ch l·ªõp</button>
          <button class="nav-page-btn" data-target="tutor-section">Gia s∆∞</button>
          <button class="nav-page-btn" data-target="parent-posts-section">B√†i ƒëƒÉng c·ªßa t√¥i</button>
          <button class="nav-page-btn" data-target="create-post-section">ƒêƒÉng b√†i t√¨m gia s∆∞</button>
        </div>
      </div>
      <div class="nav-right">
        <div class="nav-note">
          Trang web l√† s·∫£n ph·∫©m c·ªßa m√¥n h·ªçc
          <b>Qu·∫£n l√≠ d·ª± √°n cho kƒ© s∆∞ ‚Äì HK251</b>.
        </div>
        <div class="nav-right-bottom">
          <div id="guest-actions">
            <button class="btn btn-outline" id="open-register">
              <span class="btn-icon">üìù</span> ƒêƒÉng k√≠
            </button>
            <button class="btn btn-primary" id="open-login">
              <span class="btn-icon">üîê</span> ƒêƒÉng nh·∫≠p
            </button>
          </div>
          <div id="user-actions" class="hidden">
            <span id="current-user-label" class="user-pill"></span>
            <button class="btn btn-outline" id="logout-btn">ƒêƒÉng xu·∫•t</button>
          </div>
        </div>
      </div>
    </div>
  </header>

  <main>
    <!-- HOME -->
    <section id="home-section">
      <div class="container">
        <div class="hero">
          <div class="hero-grid">
            <div>
              <h1>Gia s∆∞ t·∫≠n t√¢m ‚Äì Ti·∫øn xa v·∫°n d·∫∑m</h1>
              <p class="hero-text">
                EduMentor l√† n·ªÅn t·∫£ng k·∫øt n·ªëi gia s∆∞ v√† h·ªçc vi√™n uy t√≠n, v·ªõi ƒë·ªôi ng≈© gia s∆∞ ch·∫•t l∆∞·ª£ng cao,
                ph∆∞∆°ng ph√°p gi·∫£ng d·∫°y hi·ªán ƒë·∫°i v√† h·ªá th·ªëng qu·∫£n l√Ω h·ªçc t·∫≠p th√¥ng minh. Ch√∫ng t√¥i cam k·∫øt
                mang l·∫°i tr·∫£i nghi·ªám h·ªçc t·∫≠p t·ªët nh·∫•t cho h·ªçc vi√™n.
              </p>
              <p class="hero-text">
                Ch·ªâ v·ªõi v√†i b∆∞·ªõc ƒë∆°n gi·∫£n, b·∫°n c√≥ th·ªÉ t√¨m ƒë∆∞·ª£c gia s∆∞ ph√π h·ª£p ho·∫∑c nh·∫≠n l·ªõp d·∫°y th√™m ƒë√∫ng chuy√™n m√¥n.
              </p>
              <div class="hero-cta-row">
                <button class="btn btn-primary" id="hero-go-classes">
                  üîç T√¨m l·ªõp ngay
                </button>
                <button class="btn btn-outline" id="hero-go-register">
                  ‚ú® Tr·ªü th√†nh gia s∆∞
                </button>
              </div>
              <div class="hero-badge">
                ‚≠ê H·ªó tr·ª£ k·∫øt n·ªëi minh b·∫°ch ‚Äì Ph√≠ nh·∫≠n l·ªõp r√µ r√†ng cho gia s∆∞
              </div>
            </div>
            <div class="hero-image-wrapper">
              <img
                class="hero-image"
                src="https://images.pexels.com/photos/4144222/pexels-photo-4144222.jpeg?auto=compress&cs=tinysrgb&w=900"
                alt="Gia s∆∞ h·ªó tr·ª£ h·ªçc sinh h·ªçc t·∫≠p"
              />
              <div class="hero-image-tag">
                üë©‚Äçüè´ Gia s∆∞ t·∫≠n t√¢m ¬∑ üë®‚Äçüéì H·ªçc sinh ti·∫øn b·ªô
              </div>
            </div>
          </div>
        </div>

        <div class="why-section">
          <h2 class="section-title">T·∫°i sao ch·ªçn EduMentor?</h2>
          <div class="cards-grid">
            <div class="card">
              <div class="card-icon">üéì</div>
              <div class="card-title">Gia s∆∞ ch·∫•t l∆∞·ª£ng</div>
              <div class="card-text">
                ƒê·ªôi ng≈© gia s∆∞ ƒë∆∞·ª£c tuy·ªÉn ch·ªçn k·ªπ l∆∞·ª°ng, c√≥ tr√¨nh ƒë·ªô chuy√™n m√¥n cao
                v√† kinh nghi·ªám gi·∫£ng d·∫°y phong ph√∫.
              </div>
            </div>
            <div class="card">
              <div class="card-icon">üïí</div>
              <div class="card-title">Linh ho·∫°t th·ªùi gian</div>
              <div class="card-text">
                H·ªçc m·ªçi l√∫c, m·ªçi n∆°i v·ªõi l·ªãch h·ªçc linh ho·∫°t ƒë∆∞·ª£c s·∫Øp x·∫øp theo y√™u c·∫ßu c·ªßa h·ªçc vi√™n.
              </div>
            </div>
            <div class="card">
              <div class="card-icon">üìà</div>
              <div class="card-title">Hi·ªáu qu·∫£ cao</div>
              <div class="card-text">
                Ph∆∞∆°ng ph√°p gi·∫£ng d·∫°y c√° nh√¢n h√≥a gi√∫p h·ªçc vi√™n ti·∫øp thu ki·∫øn th·ª©c nhanh ch√≥ng v√† hi·ªáu qu·∫£.
              </div>
            </div>
          </div>
        </div>

        <div class="how-section">
          <h2 class="section-title">C√°ch th·ª©c ho·∫°t ƒë·ªông</h2>
          <div class="how-cards">
            <div class="card">
              <div class="card-icon">üë§</div>
              <div class="card-title">ƒêƒÉng k√Ω t√†i kho·∫£n</div>
              <div class="card-text">
                T·∫°o t√†i kho·∫£n h·ªçc vi√™n ho·∫∑c gia s∆∞ trong v√†i b∆∞·ªõc ƒë∆°n gi·∫£n.
              </div>
            </div>
            <div class="card">
              <div class="card-icon">üîç</div>
              <div class="card-title">T√¨m ki·∫øm ph√π h·ª£p</div>
              <div class="card-text">
                H·ªçc vi√™n t√¨m gia s∆∞ ho·∫∑c gia s∆∞ t√¨m l·ªõp h·ªçc ph√π h·ª£p v·ªõi nhu c·∫ßu.
              </div>
            </div>
            <div class="card">
              <div class="card-icon">üìû</div>
              <div class="card-title">K·∫øt n·ªëi & Thanh to√°n</div>
              <div class="card-text">
                Ph·ª• huynh duy·ªát gia s∆∞, gia s∆∞ thanh to√°n ph√≠ nh·∫≠n l·ªõp ƒë·ªÉ ho√†n t·∫•t k·∫øt n·ªëi.
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- CLASSES FOR TUTOR / GUEST -->
    <section id="classes-section" class="hidden">
      <div class="container">
        <h2 class="page-title">DANH S√ÅCH B√ÄI ƒêƒÇNG C·∫¶N GIA S∆Ø</h2>
        <div id="classes-list"></div>
        <p class="muted">
          ƒêƒÉng nh·∫≠p v·ªõi vai tr√≤ <b>Gia s∆∞</b> ƒë·ªÉ b·∫•m "ƒêƒÉng k√≠ nh·∫≠n l·ªõp" v√† theo d√µi tr·∫°ng th√°i.
        </p>
      </div>
    </section>

    <!-- TUTOR PROFILE & REGISTERED CLASSES -->
    <section id="tutor-section" class="hidden">
      <div class="container">
        <h2 class="page-title">TH√îNG TIN GIA S∆Ø</h2>
        <div id="tutor-section-content"></div>
      </div>
    </section>

    <!-- TUTOR TEST -->
    <section id="test-section" class="hidden">
      <div class="container">
        <h2 class="page-title">B√ÄI KI·ªÇM TRA NƒÇNG L·ª∞C GIA S∆Ø</h2>
        <div id="test-section-content"></div>
      </div>
    </section>

    <!-- PARENT POSTS -->
    <section id="parent-posts-section" class="hidden">
      <div class="container">
        <h2 class="page-title">C√ÅC B√ÄI ƒêƒÇNG C·ª¶A PH·ª§ HUYNH - H·ªåC SINH</h2>
        <div id="parent-posts-content"></div>
      </div>
    </section>

    <!-- CREATE POST -->
    <section id="create-post-section" class="hidden">
      <div class="container">
        <h2 class="page-title">ƒêƒÇNG B√ÄI T√åM GIA S∆Ø</h2>
        <div id="create-post-content">
          <p class="muted">Vui l√≤ng ƒëƒÉng nh·∫≠p v·ªõi vai tr√≤ <b>Ph·ª• huynh/H·ªçc sinh</b> ƒë·ªÉ ƒëƒÉng b√†i.</p>
        </div>
      </div>
    </section>
  </main>

  <!-- FOOTER -->
  <footer>
    <div class="container">
      <div class="footer-top">
        <div>
          <div class="footer-title">EDU MENTOR</div>
          <p>
            K·∫øt n·ªëi gia s∆∞ ch·∫•t l∆∞·ª£ng v·ªõi h·ªçc vi√™n tr√™n to√†n qu·ªëc.<br />
            Cam k·∫øt mang l·∫°i tr·∫£i nghi·ªám h·ªçc t·∫≠p t·ªët nh·∫•t.
          </p>
          <div class="social-row">
            <span>üìò</span>
            <span>üì∏</span>
            <span>üê¶</span>
          </div>
        </div>
        <div>
          <div class="footer-title">Li√™n k·∫øt nhanh</div>
          <div class="footer-links">
            <a href="#">Trang ch·ªß</a>
            <a href="#">T√¨m gia s∆∞</a>
            <a href="#">ƒêƒÉng k√Ω gia s∆∞</a>
          </div>
        </div>
        <div>
          <div class="footer-title">Li√™n h·ªá</div>
          <p>üìû 0123 456 789</p>
          <p>‚úâ anh.nguyen2510@hcmut.edu.vn</p>
          <p>üìç Tr∆∞·ªùng ƒê·∫°i h·ªçc B√°ch khoa - ƒêHQG TP.HCM</p>
        </div>
      </div>
      <div class="footer-bottom">
        ¬© 2025 EDU MENTOR. All rights reserved.
      </div>
    </div>
  </footer>

  <!-- LOGIN MODAL -->
  <div id="login-modal" class="modal-backdrop hidden">
    <div class="modal">
      <button class="modal-close" data-close-modal="login-modal">‚úï</button>
      <div class="modal-title">ƒêƒÇNG NH·∫¨P</div>

      <div class="modal-tabs">
        <button class="modal-tab active" data-login-target="student">
          H·ªçc sinh - Ph·ª• huynh
        </button>
        <button class="modal-tab" data-login-target="tutor">
          Gia s∆∞
        </button>
      </div>

      <!-- Student / Parent -->
      <form id="login-student-form">
        <div class="form-group">
          <label>T√™n t√†i kho·∫£n *</label>
          <input id="login-student-username" type="text" class="input" placeholder="Nh·∫≠p t√™n t√†i kho·∫£n" />
        </div>
        <div class="form-group password-wrapper">
          <label>M·∫≠t kh·∫©u *</label>
          <input
            id="login-student-password"
            type="password"
            class="input password-input"
            placeholder="Nh·∫≠p m·∫≠t kh·∫©u"
          />
          <button type="button" class="toggle-password">üëÅ</button>
        </div>
        <button id="login-student-submit" type="button" class="btn btn-primary" style="width: 100%; margin-top: 8px;">
          üîì ƒêƒÉng nh·∫≠p
        </button>
      </form>

      <!-- Tutor -->
      <form id="login-tutor-form" class="hidden">
        <div class="form-group">
          <label>T√™n t√†i kho·∫£n *</label>
          <input id="login-tutor-username" type="text" class="input" placeholder="Nh·∫≠p t√™n t√†i kho·∫£n" />
        </div>
        <div class="form-group password-wrapper">
          <label>M·∫≠t kh·∫©u *</label>
          <input
            id="login-tutor-password"
            type="password"
            class="input password-input"
            placeholder="Nh·∫≠p m·∫≠t kh·∫©u"
          />
          <button type="button" class="toggle-password">üëÅ</button>
        </div>
        <button id="login-tutor-submit" type="button" class="btn btn-primary" style="width: 100%; margin-top: 8px;">
          üîì ƒêƒÉng nh·∫≠p
        </button>
      </form>

      <div class="modal-footer-text">
        B·∫°n ch∆∞a c√≥ t√†i kho·∫£n?
        <a href="#" id="open-register-from-login">ƒêƒÉng k√Ω ngay</a>
      </div>
    </div>
  </div>

  <!-- REGISTER MODAL -->
  <div id="register-modal" class="modal-backdrop hidden">
    <div class="modal">
      <button class="modal-close" data-close-modal="register-modal">‚úï</button>
      <div class="modal-title">ƒêƒÇNG K√ù T√ÄI KHO·∫¢N</div>

      <form id="register-form">
        <div class="form-group" style="display:flex; gap:10px;">
          <div style="flex:1;">
            <label>H·ªç *</label>
            <input id="reg-lastname" type="text" class="input" />
          </div>
          <div style="flex:1;">
            <label>T√™n *</label>
            <input id="reg-firstname" type="text" class="input" />
          </div>
        </div>
        <div class="form-group">
          <label>Email *</label>
          <input id="reg-email" type="email" class="input" />
        </div>
        <div class="form-group">
          <label>S·ªë ƒëi·ªán tho·∫°i *</label>
          <input id="reg-phone" type="tel" class="input" />
        </div>
        <div class="form-group">
          <label>T√™n t√†i kho·∫£n *</label>
          <input id="reg-username" type="text" class="input" />
        </div>
        <div class="form-group password-wrapper">
          <label>M·∫≠t kh·∫©u *</label>
          <input
            id="reg-password"
            type="password"
            class="input password-input"
            value="123456"
          />
          <button type="button" class="toggle-password">üëÅ</button>
        </div>
        <div class="form-group">
          <label>B·∫°n l√†</label>
          <select id="reg-role" class="select">
            <option value="gia-su">Gia s∆∞</option>
            <option value="hoc-sinh">H·ªçc sinh</option>
            <option value="phu-huynh">Ph·ª• huynh</option>
          </select>
        </div>

        <button id="register-submit" type="button" class="btn btn-primary" style="width: 100%; margin-top: 8px;">
          ‚ú® ƒêƒÉng k√Ω
        </button>
      </form>

      <div class="modal-footer-text">
        ƒê√£ c√≥ t√†i kho·∫£n? <a href="#" id="open-login-from-register">ƒêƒÉng nh·∫≠p ngay</a>
      </div>
    </div>
  </div>

  <!-- EDIT PROFILE MODAL -->
  <div id="edit-profile-modal" class="modal-backdrop hidden">
    <div class="modal">
      <button class="modal-close" data-close-modal="edit-profile-modal">‚úï</button>
      <div class="modal-title">Ch·ªânh s·ª≠a th√¥ng tin</div>

      <form>
        <div class="form-group" style="display:flex; gap:10px;">
          <div style="flex:1;">
            <label>H·ªç *</label>
            <input id="edit-lastname" type="text" class="input" />
          </div>
          <div style="flex:1;">
            <label>T√™n *</label>
            <input id="edit-firstname" type="text" class="input" />
          </div>
        </div>
        <div class="form-group">
          <label>S·ªë ƒëi·ªán tho·∫°i *</label>
          <input id="edit-phone" type="tel" class="input" />
        </div>
        <div class="form-group">
          <label>Email *</label>
          <input id="edit-email" type="email" class="input" />
        </div>
        <div class="form-group">
          <label>H·ªçc v·∫•n</label>
          <input id="edit-edu" type="text" class="input" />
        </div>
        <div class="form-group">
          <label>Kinh nghi·ªám</label>
          <input id="edit-exp" type="text" class="input" />
        </div>
        <div class="form-group">
          <label>M√¥n d·∫°y</label>
          <input id="edit-subject" type="text" class="input" />
        </div>
        <div class="form-group">
          <label>Gi·ªõi t√≠nh</label>
          <select id="edit-gender" class="select">
            <option>Nam</option>
            <option>N·ªØ</option>
            <option>Kh√°c</option>
          </select>
        </div>
        <div class="form-group">
          <label>Th√†nh t√≠ch c√° nh√¢n</label>
          <input id="edit-achievements" type="text" class="input"
                 placeholder="V√≠ d·ª•: Gi·∫£i Nh√¨ HSG To√°n t·ªânh; IELTS 7.5..." />
        </div>

        <div style="display:flex; justify-content:flex-end; gap:8px; margin-top:6px;">
          <button type="button" class="btn btn-outline" data-close-modal="edit-profile-modal">
            H·ªßy
          </button>
          <button type="button" class="btn btn-primary" id="edit-profile-save">
            L∆∞u thay ƒë·ªïi
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- PAYMENT MODAL -->
  <div id="payment-modal" class="modal-backdrop hidden">
    <div class="modal">
      <button class="modal-close" data-close-modal="payment-modal">‚úï</button>
      <div class="modal-title">Thanh to√°n ph√≠ nh·∫≠n l·ªõp</div>
      <p style="font-size:13px; color:#4a5568; margin-bottom:6px; text-align:center;">
        Gia s∆∞ vui l√≤ng thanh to√°n <b>ph√≠ nh·∫≠n l·ªõp</b> ƒë·ªÉ ho√†n t·∫•t k·∫øt n·ªëi v·ªõi ph·ª• huynh.
      </p>
      <p id="payment-fee-text" style="font-size:13px; color:#2d3748; margin-bottom:10px; text-align:center;">
        Ph√≠ nh·∫≠n l·ªõp: 25% l∆∞∆°ng th√°ng ƒë·∫ßu ti√™n.
      </p>
      <div class="qr-options">
        <div class="qr-card">
          <div class="qr-title">MoMo (Demo)</div>
          <div>S·ªë ƒëi·ªán tho·∫°i: <b>0900 000 000</b></div>
          <div>Ch·ªß t√†i kho·∫£n: <b>EDUMENTOR</b></div>
          <div class="qr-box">QR MoMo m·∫´u</div>
          <div class="qr-note">N·ªôi dung chuy·ªÉn kho·∫£n: <b>Phi nhan lop - EduMentor</b></div>
        </div>
        <div class="qr-card">
          <div class="qr-title">Vietcombank</div>
          <div>STK: <b>123456789</b></div>
          <div>Ch·ªß t√†i kho·∫£n: <b>EDUMENTOR</b></div>
          <div>Ng√¢n h√†ng: <b>VIETCOMBANK</b></div>
          <div class="qr-box">QR Vietcombank m·∫´u</div>
          <div class="qr-note">N·ªôi dung: <b>Phi nhan lop - EduMentor</b></div>
        </div>
      </div>
      <button id="payment-confirm" class="btn btn-primary" style="width:100%; margin-top:4px;">
        ‚úÖ X√°c nh·∫≠n ƒë√£ thanh to√°n
      </button>
    </div>
  </div>

  <!-- JS -->
  <script>
    /* ===== BASIC SPA NAV ===== */
    const sectionIds = [
      "home-section",
      "classes-section",
      "tutor-section",
      "test-section",
      "parent-posts-section",
      "create-post-section",
    ];
    function showSection(id) {
      sectionIds.forEach((secId) => {
        const el = document.getElementById(secId);
        if (!el) return;
        if (secId === id) el.classList.remove("hidden");
        else el.classList.add("hidden");
      });
      window.scrollTo({ top: 0, behavior: "smooth" });
    }
    document.querySelectorAll(".nav-page-btn").forEach((btn) => {
      btn.addEventListener("click", () => {
        document
          .querySelectorAll(".nav-page-btn")
          .forEach((b) => b.classList.remove("active"));
        btn.classList.add("active");
        const target = btn.getAttribute("data-target");
        if (target) showSection(target);
      });
    });

    // Hero buttons
    document.getElementById("hero-go-classes").addEventListener("click", () => {
      document
        .querySelectorAll(".nav-page-btn")
        .forEach((b) => b.classList.remove("active"));
      document
        .querySelector('.nav-page-btn[data-target="classes-section"]')
        .classList.add("active");
      showSection("classes-section");
    });
    document.getElementById("hero-go-register").addEventListener("click", () => {
      showSection("home-section");
      openModal(loginModal); // v√†o login r·ªìi chuy·ªÉn qua ƒëƒÉng k√Ω
    });

    /* ===== MODALS ===== */
    const loginModal = document.getElementById("login-modal");
    const registerModal = document.getElementById("register-modal");
    const editProfileModal = document.getElementById("edit-profile-modal");
    const paymentModal = document.getElementById("payment-modal");

    const openLoginBtn = document.getElementById("open-login");
    const openRegisterBtn = document.getElementById("open-register");

    function openModal(el) { if (el) el.classList.remove("hidden"); }
    function closeModal(el) { if (el) el.classList.add("hidden"); }

    if (openLoginBtn)
      openLoginBtn.addEventListener("click", () => openModal(loginModal));
    if (openRegisterBtn)
      openRegisterBtn.addEventListener("click", () => openModal(registerModal));

    document.querySelectorAll(".modal-close").forEach((btn) => {
      btn.addEventListener("click", () => {
        const id = btn.getAttribute("data-close-modal");
        if (id) closeModal(document.getElementById(id));
        else closeModal(btn.closest(".modal-backdrop"));
      });
    });

    document.querySelectorAll(".modal-backdrop").forEach((backdrop) => {
      backdrop.addEventListener("click", (e) => {
        if (e.target === backdrop) closeModal(backdrop);
      });
    });

    /* LOGIN TABS */
    const loginTabs = document.querySelectorAll(".modal-tab");
    const loginStudentForm = document.getElementById("login-student-form");
    const loginTutorForm = document.getElementById("login-tutor-form");
    loginTabs.forEach((tab) => {
      tab.addEventListener("click", () => {
        loginTabs.forEach((t) => t.classList.remove("active"));
        tab.classList.add("active");
        const type = tab.getAttribute("data-login-target");
        if (type === "student") {
          loginStudentForm.classList.remove("hidden");
          loginTutorForm.classList.add("hidden");
        } else {
          loginStudentForm.classList.add("hidden");
          loginTutorForm.classList.remove("hidden");
        }
      });
    });

    /* PASSWORD TOGGLE */
    document.querySelectorAll(".toggle-password").forEach((btn) => {
      btn.addEventListener("click", () => {
        const input = btn
          .closest(".password-wrapper")
          .querySelector(".password-input");
        if (input) {
          const type =
            input.getAttribute("type") === "password" ? "text" : "password";
          input.setAttribute("type", type);
        }
      });
    });

    /* SWITCH LOGIN <-> REGISTER */
    document
      .getElementById("open-register-from-login")
      .addEventListener("click", (e) => {
        e.preventDefault();
        closeModal(loginModal);
        openModal(registerModal);
      });
    document
      .getElementById("open-login-from-register")
      .addEventListener("click", (e) => {
        e.preventDefault();
        closeModal(registerModal);
        openModal(loginModal);
      });

    /* ===== SIMPLE AUTH & DATA (localStorage) ===== */
    const USERS_KEY = "edm_users_v3";
    const CURRENT_USER_KEY = "edm_current_user_v3";
    const CLASSES_KEY = "edm_classes_v1";
    const REQUESTS_KEY = "edm_requests_v1";
    const RATINGS_KEY = "edm_ratings_v1";

    function loadUsers() {
      try {
        const raw = localStorage.getItem(USERS_KEY);
        return raw ? JSON.parse(raw) : [];
      } catch { return []; }
    }
    function saveUsers(users) {
      localStorage.setItem(USERS_KEY, JSON.stringify(users));
    }
    function loadCurrentUser() {
      try {
        const raw = localStorage.getItem(CURRENT_USER_KEY);
        return raw ? JSON.parse(raw) : null;
      } catch { return null; }
    }
    function saveCurrentUser(user) {
      if (user) localStorage.setItem(CURRENT_USER_KEY, JSON.stringify(user));
      else localStorage.removeItem(CURRENT_USER_KEY);
    }

    function loadClasses() {
      try {
        const raw = localStorage.getItem(CLASSES_KEY);
        if (raw) return JSON.parse(raw);
      } catch {}
      // n·∫øu ch∆∞a c√≥ th√¨ t·∫°o 5 b√†i ƒëƒÉng m·∫´u
      const baseClasses = [
        {
          id: 1,
          parentUsername: "phuhuynh",
          parentName: "ƒê·ªó Th·ªã C",
          subject: "V·∫≠t l√Ω",
          gradeText: "H·ªçc sinh l·ªõp 11",
          address: "123 ƒë∆∞·ªùng ƒê·∫∑ng Th·ªã Nhu",
          schedule: "Th·ª© hai 2PM - 4PM",
          fee: "3.000.000 VND",
          degreeReq: "T·ªët nghi·ªáp ƒê·∫°i h·ªçc S∆∞ ph·∫°m",
          genderReq: "Kh√¥ng y√™u c·∫ßu",
          goal: "C·∫£i thi·ªán ƒëi·ªÉm",
          phone: "0123456789",
        },
        {
          id: 2,
          parentUsername: "phuhuynh",
          parentName: "ƒê·ªó Th·ªã C",
          subject: "To√°n",
          gradeText: "H·ªçc sinh l·ªõp 10",
          address: "123 ƒë∆∞·ªùng ƒê·∫∑ng Th·ªã Nhu",
          schedule: "Th·ª© hai 2PM - 4PM",
          fee: "30 USD",
          degreeReq: "T·ªët nghi·ªáp ƒê·∫°i h·ªçc S∆∞ ph·∫°m",
          genderReq: "Kh√¥ng y√™u c·∫ßu",
          goal: "C·ªßng c·ªë ki·∫øn th·ª©c",
          phone: "0123456789",
        },
        {
          id: 3,
          parentUsername: "phuhuynh",
          parentName: "Nguy·ªÖn VƒÉn A",
          subject: "H√≥a",
          gradeText: "H·ªçc sinh l·ªõp 8",
          address: "XXX ƒë∆∞·ªùng ƒê·∫∑ng Th·ªã Nhu",
          schedule: "Th·ª© hai 2PM - 4PM",
          fee: "2.000.000 VND",
          degreeReq: "T·ªët nghi·ªáp ƒê·∫°i h·ªçc S∆∞ ph·∫°m",
          genderReq: "Kh√¥ng y√™u c·∫ßu",
          goal: "C·∫£i thi·ªán ƒëi·ªÉm",
          phone: "0123456XXX",
        },
        {
          id: 4,
          parentUsername: "parent2",
          parentName: "Tr·∫ßn Th·ªã B",
          subject: "Ti·∫øng Anh",
          gradeText: "H·ªçc sinh l·ªõp 9",
          address: "YYY ƒë∆∞·ªùng L√™ L·ª£i",
          schedule: "Th·ª© ba 7PM - 9PM",
          fee: "2.500.000 VND",
          degreeReq: "Sinh vi√™n nƒÉm 3 tr·ªü l√™n",
          genderReq: "N·ªØ",
          goal: "Luy·ªán giao ti·∫øp",
          phone: "0988123456",
        },
        {
          id: 5,
          parentUsername: "parent2",
          parentName: "Ph·∫°m VƒÉn D",
          subject: "To√°n",
          gradeText: "H·ªçc sinh l·ªõp 6",
          address: "ZZZ ƒë∆∞·ªùng 3/2",
          schedule: "Th·ª© b·∫£y 8AM - 10AM",
          fee: "1.800.000 VND",
          degreeReq: "Sinh vi√™n S∆∞ ph·∫°m To√°n",
          genderReq: "Kh√¥ng y√™u c·∫ßu",
          goal: "C·ªßng c·ªë ki·∫øn th·ª©c n·ªÅn",
          phone: "0977123456",
        },
      ];
      localStorage.setItem(CLASSES_KEY, JSON.stringify(baseClasses));
      return baseClasses;
    }
    function saveClasses(classes) {
      localStorage.setItem(CLASSES_KEY, JSON.stringify(classes));
    }

    function loadRequests() {
      try {
        const raw = localStorage.getItem(REQUESTS_KEY);
        return raw ? JSON.parse(raw) : [];
      } catch { return []; }
    }
    function saveRequests(reqs) {
      localStorage.setItem(REQUESTS_KEY, JSON.stringify(reqs));
    }

    function loadRatings() {
      try {
        const raw = localStorage.getItem(RATINGS_KEY);
        return raw ? JSON.parse(raw) : [];
      } catch { return []; }
    }
    function saveRatings(ratings) {
      localStorage.setItem(RATINGS_KEY, JSON.stringify(ratings));
    }

    let users = loadUsers();
    if (!users || users.length === 0) {
      users = [
        {
          username: "kimanh",
          password: "123456",
          firstName: "Kim Anh",
          lastName: "Nguy·ªÖn",
          email: "kimanh@example.com",
          phone: "0901234567",
          role: "gia-su",
          tutorVerified: true,
          edu: "Sinh vi√™n K·ªπ thu·∫≠t M√°y t√≠nh - HCMUT",
          exp: "2 nƒÉm gia s∆∞ To√°n - L√Ω THCS",
          subject: "To√°n, L√Ω",
          achievements: "Gi·∫£i Nh√¨ HSG To√°n t·ªânh; GPA 8.7/10",
          gender: "N·ªØ",
        },
        {
          username: "thaongoc",
          password: "123456",
          firstName: "Th·∫£o Ng·ªçc",
          lastName: "Ph·∫°m",
          email: "thaongoc@example.com",
          phone: "0902345678",
          role: "gia-su",
          tutorVerified: true,
          edu: "Sinh vi√™n Khoa ƒêi·ªán - ƒêi·ªán t·ª≠ - HCMUT",
          exp: "1.5 nƒÉm gia s∆∞ V·∫≠t l√Ω",
          subject: "V·∫≠t l√Ω",
          achievements: "Gi·∫£i Ba HSG V·∫≠t l√Ω c·∫•p th√†nh ph·ªë",
          gender: "N·ªØ",
        },
        {
          username: "phuhuynh",
          password: "123456",
          firstName: "Ph∆∞∆°ng Tu·∫•n",
          lastName: "Tr·ªãnh",
          email: "tuanparent@example.com",
          phone: "0912345678",
          role: "phu-huynh",
        },
        {
          username: "parent2",
          password: "123456",
          firstName: "Lan",
          lastName: "Nguy·ªÖn",
          email: "lanparent@example.com",
          phone: "0934567890",
          role: "phu-huynh",
        },
      ];
      saveUsers(users);
    }

    let currentUser = loadCurrentUser();
    let classes = loadClasses();
    let requests = loadRequests();
    let ratings = loadRatings();

    const guestActions = document.getElementById("guest-actions");
    const userActions = document.getElementById("user-actions");
    const currentUserLabel = document.getElementById("current-user-label");
    const logoutBtn = document.getElementById("logout-btn");

    function roleToText(role) {
      if (role === "gia-su") return "Gia s∆∞";
      if (role === "phu-huynh") return "Ph·ª• huynh";
      if (role === "hoc-sinh") return "H·ªçc sinh";
      return "";
    }

    function updateAuthUI() {
      if (currentUser) {
        guestActions.classList.add("hidden");
        userActions.classList.remove("hidden");
        const fullName =
          ((currentUser.lastName || "") + " " + (currentUser.firstName || "")).trim() ||
          currentUser.username;
        const roleText = roleToText(currentUser.role);
        currentUserLabel.textContent =
          fullName + (roleText ? ` (${roleText})` : "");
      } else {
        guestActions.classList.remove("hidden");
        userActions.classList.add("hidden");
      }
      renderAll();
    }

    if (logoutBtn) {
      logoutBtn.addEventListener("click", () => {
        currentUser = null;
        saveCurrentUser(null);
        updateAuthUI();
        alert("ƒê√£ ƒëƒÉng xu·∫•t.");
      });
    }

    /* REGISTER */
    document.getElementById("register-submit").addEventListener("click", () => {
      const lastName = document.getElementById("reg-lastname").value.trim();
      const firstName = document.getElementById("reg-firstname").value.trim();
      const email = document.getElementById("reg-email").value.trim();
      const phone = document.getElementById("reg-phone").value.trim();
      const username = document.getElementById("reg-username").value.trim();
      const password = document.getElementById("reg-password").value;
      const role = document.getElementById("reg-role").value;

      if (!username || !password || !lastName || !firstName) {
        alert("Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß H·ªç, T√™n, T√†i kho·∫£n v√† M·∫≠t kh·∫©u.");
        return;
      }
      if (users.some((u) => u.username === username)) {
        alert("T√™n t√†i kho·∫£n ƒë√£ t·ªìn t·∫°i.");
        return;
      }
      const newUser = {
        username,
        password,
        firstName,
        lastName,
        email,
        phone,
        role,
      };
      if (role === "gia-su") {
        newUser.tutorVerified = false;
      }
      users.push(newUser);
      saveUsers(users);

      if (role === "gia-su") {
        currentUser = newUser;
        saveCurrentUser(currentUser);
        closeModal(registerModal);
        updateAuthUI();
        alert("ƒêƒÉng k√Ω th√†nh c√¥ng! H√£y ho√†n th√†nh b√†i ki·ªÉm tra nƒÉng l·ª±c ƒë·ªÉ b·∫Øt ƒë·∫ßu nh·∫≠n l·ªõp.");
        showSection("test-section");
      } else {
        alert("ƒêƒÉng k√Ω th√†nh c√¥ng! B√¢y gi·ªù b·∫°n c√≥ th·ªÉ ƒëƒÉng nh·∫≠p.");
        closeModal(registerModal);
        openModal(loginModal);
      }
    });

    function tryLogin(username, password) {
      username = (username || "").trim();
      if (!username || !password) {
        alert("Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß t√™n t√†i kho·∫£n v√† m·∫≠t kh·∫©u.");
        return;
      }
      const user = users.find(
        (u) => u.username === username && u.password === password
      );
      if (!user) {
        alert("Sai t√™n t√†i kho·∫£n ho·∫∑c m·∫≠t kh·∫©u.");
        return;
      }
      currentUser = user;
      saveCurrentUser(user);
      closeModal(loginModal);
      updateAuthUI();
      if (currentUser.role === "gia-su" && !currentUser.tutorVerified) {
        alert("B·∫°n c·∫ßn ho√†n th√†nh b√†i ki·ªÉm tra nƒÉng l·ª±c tr∆∞·ªõc khi nh·∫≠n l·ªõp.");
        showSection("test-section");
      } else if (currentUser.role === "gia-su") {
        showSection("tutor-section");
        document
          .querySelectorAll(".nav-page-btn")
          .forEach((b) => b.classList.remove("active"));
        document
          .querySelector('.nav-page-btn[data-target="tutor-section"]')
          .classList.add("active");
      }
    }

    document
      .getElementById("login-student-submit")
      .addEventListener("click", () => {
        const u = document
          .getElementById("login-student-username")
          .value.trim();
        const p = document.getElementById("login-student-password").value;
        tryLogin(u, p);
      });
    document
      .getElementById("login-tutor-submit")
      .addEventListener("click", () => {
        const u = document
          .getElementById("login-tutor-username")
          .value.trim();
        const p = document.getElementById("login-tutor-password").value;
        tryLogin(u, p);
      });

    /* ===== QUIZ QUESTIONS ===== */
    const QUIZ_QUESTIONS = {
      math: [
        { q: "Gi√° tr·ªã c·ªßa 2 + 3 √ó 4 l√†:", o: ["14", "20", "10", "18"], a: 0 },
        { q: "Nghi·ªám c·ªßa ph∆∞∆°ng tr√¨nh x + 5 = 9 l√†:", o: ["x = 3", "x = 4", "x = 2", "x = -4"], a: 1 },
        { q: "Di·ªán t√≠ch h√¨nh ch·ªØ nh·∫≠t c√≥ chi·ªÅu d√†i 5 v√† chi·ªÅu r·ªông 3 l√†:", o: ["15", "8", "10", "30"], a: 0 },
        { q: "S·ªë nguy√™n t·ªë nh·ªè nh·∫•t l·ªõn h∆°n 10 l√†:", o: ["11", "12", "13", "15"], a: 0 },
        { q: "Gi√° tr·ªã c·ªßa (3^2) + 4 l√†:", o: ["13", "7", "11", "9"], a: 0 },
        { q: "N·∫øu m·ªôt h√¨nh vu√¥ng c√≥ c·∫°nh 4 th√¨ chu vi l√†:", o: ["8", "12", "16", "20"], a: 2 },
        { q: "Ph·∫ßn th·∫≠p ph√¢n c·ªßa 7/2 b·∫±ng:", o: ["3.5", "3.2", "3", "2.5"], a: 0 },
        { q: "Trong tam gi√°c vu√¥ng, ƒë·ªãnh l√Ω Pythagore d√πng cho:", o: ["ƒê·ªô d√†i c·∫°nh", "Di·ªán t√≠ch", "Chu vi", "G√≥c"], a: 0 },
        { q: "T·∫≠p nghi·ªám c·ªßa b·∫•t ph∆∞∆°ng tr√¨nh x > 2 l√†:", o: ["x ‚â• 2", "x > 2", "x < 2", "x ‚â§ 2"], a: 1 },
        { q: "Gi√° tr·ªã c·ªßa 10% c·ªßa 200 l√†:", o: ["10", "20", "30", "40"], a: 1 },
      ],
      physics: [
        { q: "ƒê∆°n v·ªã ƒëo l·ª±c trong h·ªá SI l√†:", o: ["Niut∆°n (N)", "Jun (J)", "O√°t (W)", "M√©t (m)"], a: 0 },
        { q: "T·ªëc ƒë·ªô √°nh s√°ng x·∫•p x·ªâ b·∫±ng:", o: ["3√ó10^8 m/s", "3√ó10^6 m/s", "3√ó10^5 m/s", "3√ó10^4 m/s"], a: 0 },
        { q: "Th·ªùi gian chuy·ªÉn ƒë·ªông ƒë∆∞·ª£c t√≠nh b·∫±ng:", o: ["Qu√£ng ƒë∆∞·ªùng / V·∫≠n t·ªëc", "V·∫≠n t·ªëc √ó Qu√£ng ƒë∆∞·ªùng", "Kh·ªëi l∆∞·ª£ng √ó V·∫≠n t·ªëc", "L·ª±c √ó Qu√£ng ƒë∆∞·ªùng"], a: 0 },
        { q: "V·∫≠t n·ªïi tr√™n m·∫∑t n∆∞·ªõc khi:", o: ["L·ª±c ƒë·∫©y √Åc-si-m√©t l·ªõn h∆°n tr·ªçng l·ª±c", "L·ª±c ƒë·∫©y nh·ªè h∆°n tr·ªçng l·ª±c", "Kh√¥ng c√≥ l·ª±c n√†o", "Hai l·ª±c c√πng chi·ªÅu"], a: 0 },
        { q: "S·ª± truy·ªÅn nƒÉng l∆∞·ª£ng nh·ªù dao ƒë·ªông c·ªßa c√°c ph·∫ßn t·ª≠ m√¥i tr∆∞·ªùng l√†:", o: ["S√≥ng c∆°", "√Ånh s√°ng", "ƒêi·ªán tr∆∞·ªùng", "T·ª´ tr∆∞·ªùng"], a: 0 },
        { q: "Hi·ªáu ƒëi·ªán th·∫ø k√Ω hi·ªáu l√†:", o: ["U", "I", "R", "P"], a: 0 },
        { q: "C√¥ng su·∫•t ƒëi·ªán P ƒë∆∞·ª£c t√≠nh b·∫±ng:", o: ["U¬∑I", "U/I", "I/R", "U¬∑R"], a: 0 },
        { q: "Qu√°n t√≠nh ph·ª• thu·ªôc v√†o:", o: ["Kh·ªëi l∆∞·ª£ng", "Th·ªÉ t√≠ch", "Nhi·ªát ƒë·ªô", "Di·ªán t√≠ch"], a: 0 },
        { q: "Chuy·ªÉn ƒë·ªông ƒë·ªÅu l√† chuy·ªÉn ƒë·ªông c√≥:", o: ["V·∫≠n t·ªëc kh√¥ng ƒë·ªïi", "Gia t·ªëc kh√¥ng ƒë·ªïi", "Qu√£ng ƒë∆∞·ªùng b·∫±ng nhau trong th·ªùi gian b·∫•t k·ª≥", "Gia t·ªëc b·∫±ng 0"], a: 0 },
        { q: "Nhi·ªát ƒë·ªô ƒëo b·∫±ng ƒë·ªô C (¬∞C) c√≥ th·ªÉ chuy·ªÉn sang K b·∫±ng c√¥ng th·ª©c:", o: ["K = C + 273", "K = C - 273", "K = 2C", "K = C/2"], a: 0 },
      ],
      chemistry: [
        { q: "Nguy√™n t·ª≠ s·ªë 1 trong b·∫£ng tu·∫ßn ho√†n l√†:", o: ["H", "He", "O", "C"], a: 0 },
        { q: "C√¥ng th·ª©c h√≥a h·ªçc c·ªßa n∆∞·ªõc l√†:", o: ["H2O", "CO2", "NaCl", "HCl"], a: 0 },
        { q: "S·ªë proton trong h·∫°t nh√¢n oxy (O) l√†:", o: ["8", "16", "6", "12"], a: 0 },
        { q: "Dung d·ªãch c√≥ pH < 7 l√†:", o: ["Axit", "Baz∆°", "Trung t√≠nh", "Mu·ªëi"], a: 0 },
        { q: "NaCl c√≤n g·ªçi l√†:", o: ["Mu·ªëi ƒÉn", "V√¥i", "Axit", "ƒê∆∞·ªùng"], a: 0 },
        { q: "Qu√° tr√¨nh chuy·ªÉn t·ª´ l·ªèng sang kh√≠ g·ªçi l√†:", o: ["Bay h∆°i", "Ng∆∞ng t·ª•", "ThƒÉng hoa", "ƒê√¥ng ƒë·∫∑c"], a: 0 },
        { q: "H√≥a tr·ªã c·ªßa Na trong h·ª£p ch·∫•t NaCl l√†:", o: ["I", "II", "III", "IV"], a: 0 },
        { q: "Kh√≠ g√¢y hi·ªáu ·ª©ng nh√† k√≠nh ch√≠nh l√†:", o: ["CO2", "O2", "N2", "H2"], a: 0 },
        { q: "Ph·∫£n ·ª©ng ch√°y l√† ph·∫£n ·ª©ng ho√° h·ªçc c√≥ s·ª± tham gia c·ªßa:", o: ["Oxi", "Nit∆°", "Hiƒëro", "Clo"], a: 0 },
        { q: "D√£y kim lo·∫°i ho·∫°t ƒë·ªông m·∫°nh gi·∫£m d·∫ßn l√†:", o: ["K, Na, Ca, Mg, Al", "Na, K, Ca, Mg, Al", "Al, Mg, Ca, Na, K", "Na, Ca, Mg, Al, K"], a: 0 },
      ],
      literature: [
        { q: "Th·ªÉ th∆° l·ª•c b√°t c√≥ s·ªë ch·ªØ ·ªü c√¢u l·ª•c v√† b√°t l·∫ßn l∆∞·ª£t l√†:", o: ["6 v√† 8", "5 v√† 7", "7 v√† 8", "4 v√† 6"], a: 0 },
        { q: "T√°c gi·∫£ c·ªßa Truy·ªán Ki·ªÅu l√†:", o: ["Nguy·ªÖn Du", "Nguy·ªÖn Tr√£i", "H·ªì Xu√¢n H∆∞∆°ng", "Xu√¢n Di·ªáu"], a: 0 },
        { q: "Nh√¢n v·∫≠t L√£o H·∫°c xu·∫•t hi·ªán trong t√°c ph·∫©m c·ªßa:", o: ["Nam Cao", "Ng√¥ T·∫•t T·ªë", "Nguy·ªÖn C√¥ng Hoan", "Nguy·ªÖn Minh Ch√¢u"], a: 0 },
        { q: "‚ÄúL≈©y tre xanh‚Äù th∆∞·ªùng d√πng ƒë·ªÉ n√≥i v·ªÅ:", o: ["L√†ng qu√™ Vi·ªát Nam", "R·ª´ng n√∫i", "Th√†nh ph·ªë", "Bi·ªÉn ƒë·∫£o"], a: 0 },
        { q: "Phong c√°ch ng√¥n ng·ªØ d√πng trong ngh·ªã lu·∫≠n x√£ h·ªôi l√†:", o: ["Ngh·ªã lu·∫≠n", "T·ª± s·ª±", "Bi·ªÉu c·∫£m", "Thuy·∫øt minh"], a: 0 },
        { q: "T·ª´ l√°y trong ti·∫øng Vi·ªát l√†:", o: ["T·ª´ ƒë∆∞·ª£c t·∫°o b·ªüi s·ª± l·∫∑p √¢m", "T·ª´ ch·ªâ ho·∫°t ƒë·ªông", "T·ª´ ch·ªâ s·ª± v·∫≠t", "T·ª´ m∆∞·ª£n"], a: 0 },
        { q: "Trong th∆°, h√¨nh ·∫£nh trƒÉng th∆∞·ªùng g·ª£i ƒë·∫øn:", o: ["V·∫ª ƒë·∫πp, s·ª± b√¨nh y√™n", "Chi·∫øn tranh", "√î nhi·ªÖm", "Th∆∞∆°ng m·∫°i"], a: 0 },
        { q: "ƒêi·ªÅn t·ª´ th√≠ch h·ª£p: ‚ÄúC√¥ng cha nh∆∞ n√∫i Th√°i S∆°n, nghƒ©a m·∫π nh∆∞‚Ä¶": o: ["n∆∞·ªõc trong ngu·ªìn ch·∫£y ra", "bi·ªÉn Th√°i B√¨nh d·∫°t d√†o", "s√¥ng d√†i", "tr·ªùi cao"], a: 1 },
        { q: "VƒÉn b·∫£n thuy·∫øt minh ch·ªß y·∫øu nh·∫±m:", o: ["Cung c·∫•p th√¥ng tin, tri th·ª©c", "B·ªôc l·ªô c·∫£m x√∫c", "K·ªÉ l·∫°i c√¢u chuy·ªán", "Tranh lu·∫≠n"], a: 0 },
        { q: "Nh√¢n v·∫≠t 'ch·ªã D·∫≠u' thu·ªôc t√°c ph·∫©m:", o: ["T·∫Øt ƒë√®n", "L√£o H·∫°c", "V·ª£ nh·∫∑t", "S·ªëng m√≤n"], a: 0 },
      ],
      english: [
        { q: "Ch·ªçn c√¢u ƒë√∫ng: She ___ to school every day.", o: ["goes", "go", "going", "gone"], a: 0 },
        { q: "T·ª´ ƒë·ªìng nghƒ©a v·ªõi 'happy' l√†:", o: ["glad", "sad", "angry", "tired"], a: 0 },
        { q: "ƒêi·ªÅn gi·ªõi t·ª´: I am interested ___ math.", o: ["in", "on", "at", "for"], a: 0 },
        { q: "Qu√° kh·ª© ƒë∆°n c·ªßa 'buy' l√†:", o: ["bought", "buyed", "buys", "been"], a: 0 },
        { q: "C√¢u h·ªèi: 'How old are you?' d√πng ƒë·ªÉ h·ªèi:", o: ["tu·ªïi", "t√™n", "ƒë·ªãa ch·ªâ", "s·ªü th√≠ch"], a: 0 },
        { q: "T·ª´ tr√°i nghƒ©a v·ªõi 'big' l√†:", o: ["small", "long", "tall", "high"], a: 0 },
        { q: "ƒêi·ªÅn: There ___ two cats in the garden.", o: ["are", "is", "be", "am"], a: 0 },
        { q: "Ch·ªçn gi·ªõi t·ª´: He is good ___ English.", o: ["at", "in", "on", "for"], a: 0 },
        { q: "D·ªãch: 'library' nghƒ©a l√†:", o: ["th∆∞ vi·ªán", "ph√≤ng th√≠ nghi·ªám", "nh√† ƒÉn", "s√¢n v·∫≠n ƒë·ªông"], a: 0 },
        { q: "Ch·ªçn c√¢u ƒë√∫ng th√¨ hi·ªán t·∫°i ti·∫øp di·ªÖn:", o: ["She is studying now.", "She study now.", "She studying now.", "She studies now."], a: 0 },
      ],
      biology: [
        { q: "ƒê∆°n v·ªã c·∫•u t·∫°o c∆° b·∫£n c·ªßa c∆° th·ªÉ s·ªëng l√†:", o: ["T·∫ø b√†o", "M√¥", "C∆° quan", "H·ªá c∆° quan"], a: 0 },
        { q: "Qu√° tr√¨nh c√¢y xanh t·∫°o ra ch·∫•t h·ªØu c∆° g·ªçi l√†:", o: ["Quang h·ª£p", "H√¥ h·∫•p", "Tho√°t h∆°i n∆∞·ªõc", "V·∫≠n chuy·ªÉn"], a: 0 },
        { q: "C∆° quan h√¥ h·∫•p ch√≠nh c·ªßa ng∆∞·ªùi l√†:", o: ["Ph·ªïi", "Tim", "Gan", "Th·∫≠n"], a: 0 },
        { q: "M√°u ƒë·ªè t∆∞∆°i do k·∫øt h·ª£p v·ªõi:", o: ["Oxi", "CO2", "N∆∞·ªõc", "Mu·ªëi kho√°ng"], a: 0 },
        { q: "B·ªô ph·∫≠n n√†o c·ªßa c√¢y gi√∫p h·∫•p th·ª• n∆∞·ªõc v√† mu·ªëi kho√°ng:", o: ["R·ªÖ", "Th√¢n", "L√°", "Hoa"], a: 0 },
        { q: "H·ªá th·∫ßn kinh trung ∆∞∆°ng g·ªìm:", o: ["N√£o v√† t·ªßy s·ªëng", "Tim v√† ph·ªïi", "Gan v√† th·∫≠n", "D·∫° d√†y v√† ru·ªôt"], a: 0 },
        { q: "Nh√≥m sinh v·∫≠t n√†o sau ƒë√¢y l√† ƒë·ªông v·∫≠t c√≥ x∆∞∆°ng s·ªëng:", o: ["C√°", "S·ª©a", "S√¢u b·ªç", "Sao bi·ªÉn"], a: 0 },
        { q: "Quang h·ª£p di·ªÖn ra ch·ªß y·∫øu ·ªü b·ªô ph·∫≠n:", o: ["L√°", "R·ªÖ", "Th√¢n g·ªó", "Hoa"], a: 0 },
        { q: "ADN n·∫±m ch·ªß y·∫øu ·ªü:", o: ["Nh√¢n t·∫ø b√†o", "M√†ng t·∫ø b√†o", "T·∫ø b√†o ch·∫•t", "Kh√¥ng b√†o"], a: 0 },
        { q: "S·ª± ph√¢n b√†o t·∫°o giao t·ª≠ l√†:", o: ["Gi·∫£m ph√¢n", "Nguy√™n ph√¢n", "H√¥ h·∫•p", "Quang h·ª£p"], a: 0 },
      ],
      history: [
        { q: "Nh√† n∆∞·ªõc VƒÉn Lang do vua n√†o ƒë·ª©ng ƒë·∫ßu?", o: ["H√πng V∆∞∆°ng", "An D∆∞∆°ng V∆∞∆°ng", "L√Ω Th√°i T·ªï", "Quang Trung"], a: 0 },
        { q: "Chi·∫øn th·∫Øng B·∫°ch ƒê·∫±ng nƒÉm 938 g·∫Øn v·ªõi nh√¢n v·∫≠t:", o: ["Ng√¥ Quy·ªÅn", "L√Ω Th∆∞·ªùng Ki·ªát", "Tr·∫ßn H∆∞ng ƒê·∫°o", "L√™ L·ª£i"], a: 0 },
        { q: "Cu·ªôc kh√°ng chi·∫øn ch·ªëng qu√¢n M√¥ng - Nguy√™n l·∫ßn th·ª© 3 do ai l√£nh ƒë·∫°o?", o: ["Tr·∫ßn H∆∞ng ƒê·∫°o", "Ng√¥ Quy·ªÅn", "L√Ω Th∆∞·ªùng Ki·ªát", "Quang Trung"], a: 0 },
        { q: "C√°ch m·∫°ng th√°ng T√°m ·ªü Vi·ªát Nam di·ªÖn ra nƒÉm:", o: ["1945", "1930", "1954", "1975"], a: 0 },
        { q: "Hi·ªáp ƒë·ªãnh Gi∆°-ne-v∆° v·ªÅ ch·∫•m d·ª©t chi·∫øn tranh ·ªü ƒê√¥ng D∆∞∆°ng ƒë∆∞·ª£c k√Ω nƒÉm:", o: ["1954", "1945", "1968", "1973"], a: 0 },
        { q: "Chi·∫øn th·∫Øng ƒêi·ªán Bi√™n Ph·ªß di·ªÖn ra nƒÉm:", o: ["1954", "1946", "1975", "1968"], a: 0 },
        { q: "Ng√†y Qu·ªëc kh√°nh n∆∞·ªõc CHXHCN Vi·ªát Nam l√†:", o: ["2/9/1945", "30/4/1975", "3/2/1930", "19/5/1890"], a: 0 },
        { q: "Phong tr√†o 'ƒê·ªìng kh·ªüi' b√πng n·ªï m·∫°nh m·∫Ω nƒÉm:", o: ["1960", "1954", "1945", "1975"], a: 0 },
        { q: "Nh√¢n v·∫≠t g·∫Øn v·ªõi kh·∫©u hi·ªáu 'Kh√¥ng c√≥ g√¨ qu√Ω h∆°n ƒë·ªôc l·∫≠p, t·ª± do' l√†:", o: ["H·ªì Ch√≠ Minh", "Tr∆∞·ªùng Chinh", "V√µ Nguy√™n Gi√°p", "Ph·∫°m VƒÉn ƒê·ªìng"], a: 0 },
        { q: "Th·∫Øng l·ª£i m√πa Xu√¢n 1975 k·∫øt th√∫c b·∫±ng chi·∫øn d·ªãch:", o: ["H·ªì Ch√≠ Minh", "ƒêi·ªán Bi√™n Ph·ªß", "Bi√™n gi·ªõi", "ƒê∆∞·ªùng 9 Nam L√†o"], a: 0 },
      ],
      geography: [
        { q: "Tr√°i ƒê·∫•t quay quanh M·∫∑t Tr·ªùi theo qu·ªπ ƒë·∫°o:", o: ["H√¨nh elip", "H√¨nh tr√≤n", "H√¨nh vu√¥ng", "H√¨nh ch·ªØ nh·∫≠t"], a: 0 },
        { q: "ƒê∆∞·ªùng x√≠ch ƒë·∫°o c√≥ vƒ© ƒë·ªô:", o: ["0¬∞", "90¬∞ B·∫Øc", "90¬∞ Nam", "45¬∞"], a: 0 },
        { q: "Bi·ªÉn ƒê√¥ng l√† m·ªôt b·ªô ph·∫≠n c·ªßa:", o: ["Th√°i B√¨nh D∆∞∆°ng", "·∫§n ƒê·ªô D∆∞∆°ng", "ƒê·∫°i T√¢y D∆∞∆°ng", "B·∫Øc BƒÉng D∆∞∆°ng"], a: 0 },
        { q: "Vi·ªát Nam kh√¥ng gi√°p qu·ªëc gia n√†o sau ƒë√¢y:", o: ["·∫§n ƒê·ªô", "Trung Qu·ªëc", "L√†o", "Campuchia"], a: 0 },
        { q: "S√¥ng d√†i nh·∫•t Vi·ªát Nam l√†:", o: ["S√¥ng H·ªìng", "S√¥ng Mekong (C·ª≠u Long)", "S√¥ng ƒê√†", "S√¥ng Thu B·ªìn"], a: 1 },
        { q: "Kh√≠ h·∫≠u Vi·ªát Nam ch·ªß y·∫øu l√†:", o: ["Nhi·ªát ƒë·ªõi gi√≥ m√πa", "√în ƒë·ªõi", "H√†n ƒë·ªõi", "C·∫≠n c·ª±c"], a: 0 },
        { q: "Th·ªß ƒë√¥ c·ªßa Vi·ªát Nam l√†:", o: ["H√† N·ªôi", "TP. H·ªì Ch√≠ Minh", "ƒê√† N·∫µng", "Hu·∫ø"], a: 0 },
        { q: "V√πng ƒë·ªìng b·∫±ng l·ªõn nh·∫•t n∆∞·ªõc ta l√†:", o: ["ƒê·ªìng b·∫±ng s√¥ng C·ª≠u Long", "ƒê·ªìng b·∫±ng s√¥ng H·ªìng", "ƒê·ªìng b·∫±ng duy√™n h·∫£i", "T√¢y Nguy√™n"], a: 0 },
        { q: "Kho√°ng s·∫£n than ƒë√° t·∫≠p trung nhi·ªÅu ·ªü:", o: ["Qu·∫£ng Ninh", "ƒê·ªìng Nai", "An Giang", "Gia Lai"], a: 0 },
        { q: "Bi·ªÉn n√†o sau ƒë√¢y n·∫±m ph√≠a ƒê√¥ng Vi·ªát Nam:", o: ["Bi·ªÉn ƒê√¥ng", "Bi·ªÉn ƒêen", "Bi·ªÉn ƒê·ªè", "Bi·ªÉn Caspi"], a: 0 },
      ],
    };

    /* ===== RENDER :::::::: */

    function getRequestStatusForTutor(classId, tutorUsername) {
      const req = requests.find(
        (r) => r.classId === classId && r.tutor === tutorUsername
      );
      return req ? req.status : null;
    }

    function renderClassesList() {
      const container = document.getElementById("classes-list");
      if (!container) return;
      let html = "";
      classes.forEach((c) => {
        const title = c.parentName;
        const subtitle = `C·∫ßn gia s∆∞ m√¥n ${c.subject} ¬∑ ${c.gradeText}`;
        let actionHtml = "";
        let phone = c.phone || "0123456XXX";

        if (currentUser && currentUser.role === "gia-su") {
          if (!currentUser.tutorVerified) {
            actionHtml = `
              <button class="btn btn-primary btn-need-test">
                L√†m b√†i ki·ªÉm tra ƒë·ªÉ nh·∫≠n l·ªõp
              </button>
            `;
          } else {
            const status = getRequestStatusForTutor(c.id, currentUser.username);
            if (!status) {
              actionHtml = `
                <button class="btn btn-primary btn-request" data-class-id="${c.id}">
                  ƒêƒÇNG K√ç NH·∫¨N L·ªöP
                </button>
              `;
            } else if (status === "pending") {
              actionHtml = `<span class="status-pill status-wait">Vui l√≤ng ch·ªù ph·ª• huynh x√°c nh·∫≠n</span>`;
            } else if (status === "accepted") {
              actionHtml = `<span class="status-pill status-accepted">B·∫°n ƒë√£ ƒë∆∞·ª£c ch·ªçn ¬∑ Ch·ªù thanh to√°n ph√≠ nh·∫≠n l·ªõp</span>`;
            } else if (status === "rejected") {
              actionHtml = `<span class="status-pill status-rejected">R·∫•t ti·∫øc, ƒë√£ c√≥ ng∆∞·ªùi kh√°c ƒë∆∞·ª£c ch·ªçn</span>`;
            } else if (status === "paid") {
              actionHtml = `<span class="status-pill status-connected">K·∫øt n·ªëi l·ªõp th√†nh c√¥ng</span>`;
            }
          }
        } else {
          actionHtml =
            '<span class="muted" style="font-size:12px;">ƒêƒÉng nh·∫≠p vai tr√≤ Gia s∆∞ ƒë·ªÉ ƒëƒÉng k√≠ l·ªõp</span>';
        }

        html += `
          <div class="class-card">
            <div class="class-top-row">
              <div class="avatar-circle">${title[0]}</div>
              <div class="class-main">
                <div class="class-name">${title}</div>
                <div class="class-subtitle">${subtitle}</div>

                <div class="class-info-grid">
                  <div class="info-item">
                    <span class="info-icon">üìç</span>
                    <span>${c.address}</span>
                  </div>
                  <div class="info-item">
                    <span class="info-icon">‚è∞</span>
                    <span>Th·ªùi gian h·ªçc: ${c.schedule}</span>
                  </div>
                  <div class="info-item">
                    <span class="info-icon">üí∞</span>
                    <span>M·ª©c l∆∞∆°ng d·ª± ki·∫øn: ${c.fee}</span>
                  </div>
                  <div class="info-item">
                    <span class="info-icon">üéì</span>
                    <span>Y√™u c·∫ßu b·∫±ng c·∫•p: ${c.degreeReq}</span>
                  </div>
                  <div class="info-item">
                    <span class="info-icon">üë•</span>
                    <span>Y√™u c·∫ßu gi·ªõi t√≠nh gia s∆∞: ${c.genderReq}</span>
                  </div>
                  <div class="info-item">
                    <span class="info-icon">üìö</span>
                    <span>M·ª•c ti√™u h·ªçc t·∫≠p: ${c.goal}</span>
                  </div>
                </div>
              </div>
            </div>
            <div class="class-bottom-row">
              <span class="phone-link">${phone}</span>
              <div class="class-actions">${actionHtml}</div>
            </div>
          </div>
        `;
      });
      container.innerHTML = html;

      container.querySelectorAll(".btn-request").forEach((btn) => {
        btn.addEventListener("click", () => {
          if (!currentUser || currentUser.role !== "gia-su") {
            alert("Vui l√≤ng ƒëƒÉng nh·∫≠p v·ªõi vai tr√≤ Gia s∆∞.");
            return;
          }
          if (!currentUser.tutorVerified) {
            alert("B·∫°n c·∫ßn ho√†n th√†nh b√†i ki·ªÉm tra nƒÉng l·ª±c tr∆∞·ªõc khi nh·∫≠n l·ªõp.");
            showSection("test-section");
            return;
          }
          const classId = Number(btn.getAttribute("data-class-id"));
          if (
            requests.some(
              (r) => r.classId === classId && r.tutor === currentUser.username
            )
          ) {
            alert("B·∫°n ƒë√£ ƒëƒÉng k√≠ l·ªõp n√†y r·ªìi.");
            return;
          }
          requests.push({
            classId,
            tutor: currentUser.username,
            status: "pending",
          });
          saveRequests(requests);
          renderAll();
          alert("ƒê√£ g·ª≠i y√™u c·∫ßu nh·∫≠n l·ªõp. Vui l√≤ng ch·ªù ph·ª• huynh ch·∫•p nh·∫≠n.");
        });
      });

      container.querySelectorAll(".btn-need-test").forEach((btn) => {
        btn.addEventListener("click", () => {
          alert("B·∫°n c·∫ßn ho√†n th√†nh b√†i ki·ªÉm tra nƒÉng l·ª±c (ƒë·∫°t t·ª´ 8/10) ƒë·ªÉ nh·∫≠n l·ªõp.");
          showSection("test-section");
        });
      });
    }

    function renderTutorSection() {
      const container = document.getElementById("tutor-section-content");
      if (!container) return;

      if (!currentUser || currentUser.role !== "gia-su") {
        container.innerHTML =
          '<p class="muted">Vui l√≤ng ƒëƒÉng nh·∫≠p v·ªõi vai tr√≤ <b>Gia s∆∞</b> ƒë·ªÉ xem th√¥ng tin.</p>';
        return;
      }

      const fullName =
        ((currentUser.lastName || "") + " " + (currentUser.firstName || "")).trim() ||
        currentUser.username;

      const phone = currentUser.phone || "Ch∆∞a c·∫≠p nh·∫≠t";
      const email = currentUser.email || "Ch∆∞a c·∫≠p nh·∫≠t";
      const edu = currentUser.edu || "T·ªët nghi·ªáp ƒê·∫°i h·ªçc S∆∞ ph·∫°m";
      const subject = currentUser.subject || "To√°n";
      const exp = currentUser.exp || "2 nƒÉm l√†m gia s∆∞";
      const gender = currentUser.gender || "Nam/N·ªØ";
      const achievements = currentUser.achievements || "Ch∆∞a c·∫≠p nh·∫≠t";

      const tutorRequests = requests.filter(
        (r) => r.tutor === currentUser.username
      );

      const tutorRatings = ratings.filter(
        (rt) => rt.tutor === currentUser.username
      );
      let ratingText = "Ch∆∞a c√≥ ƒë√°nh gi√°";
      if (tutorRatings.length > 0) {
        const avg =
          tutorRatings.reduce((sum, r) => sum + (r.stars || 0), 0) /
          tutorRatings.length;
        ratingText =
          avg.toFixed(1) + ` / 5 (${tutorRatings.length} ƒë√°nh gi√°)`;
      }

      let classesHtml = "";
      tutorRequests.forEach((req) => {
        const c = classes.find((cl) => cl.id === req.classId);
        if (!c) return;
        const subtitle = `C·∫ßn gia s∆∞ m√¥n ${c.subject} ¬∑ ${c.gradeText}`;
        let statusClass = "status-wait";
        let statusText = "Vui l√≤ng ch·ªù ph·ª• huynh x√°c nh·∫≠n";
        let extraActions = "";

        if (req.status === "accepted") {
          statusClass = "status-accepted";
          statusText = "B·∫°n ƒë√£ ƒë∆∞·ª£c ph·ª• huynh ch·ªçn. Vui l√≤ng thanh to√°n ph√≠ nh·∫≠n l·ªõp.";
          extraActions = `
            <button type="button" class="btn btn-primary btn-xs"
              data-pay-class="${c.id}" data-pay-tutor="${currentUser.username}">
              Thanh to√°n ph√≠ nh·∫≠n l·ªõp
            </button>
          `;
        } else if (req.status === "rejected") {
          statusClass = "status-rejected";
          statusText = "R·∫•t ti·∫øc, ƒë√£ c√≥ ng∆∞·ªùi kh√°c ƒë∆∞·ª£c ch·ªçn";
        } else if (req.status === "paid") {
          statusClass = "status-connected";
          statusText = "K·∫øt n·ªëi l·ªõp th√†nh c√¥ng üéâ";
        }

        classesHtml += `
          <div class="class-card">
            <div class="class-top-row">
              <div class="avatar-circle">${c.parentName[0]}</div>
              <div class="class-main">
                <div class="class-name">${c.parentName}</div>
                <div class="class-subtitle">${subtitle}</div>
                <div class="class-info-grid">
                  <div class="info-item"><span class="info-icon">üìç</span><span>${c.address}</span></div>
                  <div class="info-item"><span class="info-icon">‚è∞</span><span>Th·ªùi gian h·ªçc: ${c.schedule}</span></div>
                  <div class="info-item"><span class="info-icon">üí∞</span><span>M·ª©c l∆∞∆°ng d·ª± ki·∫øn: ${c.fee}</span></div>
                  <div class="info-item"><span class="info-icon">üéì</span><span>Y√™u c·∫ßu b·∫±ng c·∫•p: ${c.degreeReq}</span></div>
                  <div class="info-item"><span class="info-icon">üë•</span><span>Gi·ªõi t√≠nh gia s∆∞: ${c.genderReq}</span></div>
                  <div class="info-item"><span class="info-icon">üìö</span><span>M·ª•c ti√™u h·ªçc t·∫≠p: ${c.goal}</span></div>
                </div>
              </div>
            </div>
            <div class="class-bottom-row">
              <span class="phone-link">${c.phone || "0123456XXX"}</span>
              <div class="class-actions">
                <span class="status-pill ${statusClass}">${statusText}</span>
                ${extraActions}
              </div>
            </div>
          </div>
        `;
      });

      if (!classesHtml) {
        classesHtml =
          '<p class="muted">B·∫°n ch∆∞a ƒëƒÉng k√≠ l·ªõp n√†o. H√£y v√†o "Danh s√°ch l·ªõp" ƒë·ªÉ ƒëƒÉng k√≠ sau khi ƒë√£ v∆∞·ª£t qua b√†i ki·ªÉm tra nƒÉng l·ª±c.</p>';
      }

      let verifyBanner = "";
      if (!currentUser.tutorVerified) {
        verifyBanner = `
          <div style="margin-bottom:14px; padding:10px 12px; border-radius:10px; background:var(--status-wait-bg); color:var(--status-wait-text); font-size:13px;">
            ‚è≥ T√†i kho·∫£n gia s∆∞ c·ªßa b·∫°n <b>ch∆∞a ƒë∆∞·ª£c x√°c th·ª±c</b>. H√£y ho√†n th√†nh b√†i ki·ªÉm tra nƒÉng l·ª±c (ƒë·∫°t t·ª´ 8/10 c√¢u ƒë√∫ng) ƒë·ªÉ b·∫Øt ƒë·∫ßu nh·∫≠n l·ªõp.
            <button class="btn btn-primary btn-xs" id="btn-go-test" style="margin-left:6px;">L√†m b√†i ki·ªÉm tra</button>
          </div>
        `;
      }

      let ratingListHtml = "";
      if (tutorRatings.length > 0) {
        ratingListHtml =
          '<div class="rating-list"><strong>Nh·∫≠n x√©t t·ª´ ph·ª• huynh:</strong>';
        tutorRatings.forEach((rt) => {
          ratingListHtml += `
            <div class="rating-item">
              ‚≠ê ${rt.stars}/5 ¬∑ <i>${rt.parentName || "Ph·ª• huynh ·∫©n danh"}</i><br/>
              ${rt.comment || ""}
            </div>
          `;
        });
        ratingListHtml += "</div>";
      }

      container.innerHTML = `
        ${verifyBanner}
        <div class="profile-card">
          <div class="profile-avatar" id="profile-avatar">
            <img src="https://images.pexels.com/photos/1181398/pexels-photo-1181398.jpeg?auto=compress&cs=tinysrgb&w=400" alt="Tutor" />
          </div>
          <div style="flex:1">
            <div class="profile-header">
              <div class="profile-name" id="profile-name">${fullName}</div>
              <button class="btn btn-outline" id="open-edit-profile">‚öô Ch·ªânh s·ª≠a th√¥ng tin</button>
            </div>
            <div class="profile-main">
              <div><strong>H·ªç v√† t√™n:</strong> <span id="profile-fullname">${fullName}</span></div>
              <div><strong>Gi·ªõi t√≠nh:</strong> <span id="profile-gender">${gender}</span></div>
              <div><strong>S·ªë ƒëi·ªán tho·∫°i:</strong> <span id="profile-phone">${phone}</span></div>
              <div><strong>Email:</strong> <span id="profile-email">${email}</span></div>
              <div><strong>H·ªçc v·∫•n:</strong> <span id="profile-edu">${edu}</span></div>
              <div><strong>M√¥n d·∫°y:</strong> <span id="profile-subject">${subject}</span></div>
              <div><strong>Kinh nghi·ªám:</strong> <span id="profile-exp">${exp}</span></div>
              <div style="grid-column:1 / -1;"><strong>Th√†nh t√≠ch:</strong> <span id="profile-achievements">${achievements}</span></div>
            </div>
            <span class="rating-badge">ƒê√°nh gi√°: ${ratingText}</span>
            ${ratingListHtml}
          </div>
        </div>

        <h2 class="page-title" style="margin-top:10px;">C√ÅC L·ªöP GIA S∆Ø ƒê√É ƒêƒÇNG K√ç</h2>
        ${classesHtml}
      `;

      const editBtn = document.getElementById("open-edit-profile");
      if (editBtn) {
        editBtn.addEventListener("click", () => {
          document.getElementById("edit-lastname").value =
            currentUser.lastName || "";
          document.getElementById("edit-firstname").value =
            currentUser.firstName || "";
          document.getElementById("edit-phone").value =
            currentUser.phone || "";
          document.getElementById("edit-email").value =
            currentUser.email || "";
          document.getElementById("edit-edu").value = currentUser.edu || "";
          document.getElementById("edit-exp").value = currentUser.exp || "";
          document.getElementById("edit-subject").value =
            currentUser.subject || "";
          document.getElementById("edit-gender").value =
            currentUser.gender || "Nam";
          document.getElementById("edit-achievements").value =
            currentUser.achievements || "";
          openModal(editProfileModal);
        });
      }

      const goTestBtn = document.getElementById("btn-go-test");
      if (goTestBtn) {
        goTestBtn.addEventListener("click", () => {
          showSection("test-section");
        });
      }

      // n√∫t thanh to√°n ph√≠ nh·∫≠n l·ªõp (tutor side)
      container.querySelectorAll("[data-pay-class]").forEach((btn) => {
        btn.addEventListener("click", () => {
          const classId = Number(btn.getAttribute("data-pay-class"));
          const tutorUsername = btn.getAttribute("data-pay-tutor");
          const cls = classes.find((c) => c.id === classId);
          paymentTarget = { classId, tutor: tutorUsername };
          const feeTextEl = document.getElementById("payment-fee-text");
          if (feeTextEl && cls) {
            const feeInfo = computeCommissionText(cls.fee);
            feeTextEl.textContent =
              "Ph√≠ nh·∫≠n l·ªõp: 25% l∆∞∆°ng th√°ng ƒë·∫ßu ti√™n = " + feeInfo;
          }
          openModal(paymentModal);
        });
      });
    }

    let paymentTarget = null; // {classId, tutor}

    function renderParentPosts() {
      const container = document.getElementById("parent-posts-content");
      if (!container) return;

      if (!currentUser || currentUser.role !== "phu-huynh") {
        container.innerHTML =
          '<p class="muted">Vui l√≤ng ƒëƒÉng nh·∫≠p v·ªõi vai tr√≤ <b>Ph·ª• huynh</b> ƒë·ªÉ xem c√°c b√†i ƒëƒÉng.</p>';
        return;
      }

      const myClasses = classes.filter(
        (c) => c.parentUsername === currentUser.username
      );
      if (myClasses.length === 0) {
        container.innerHTML =
          '<p class="muted">B·∫°n ch∆∞a c√≥ b√†i ƒëƒÉng n√†o. H√£y v√†o "ƒêƒÉng b√†i t√¨m gia s∆∞" ƒë·ªÉ t·∫°o b√†i m·ªõi.</p>';
        return;
      }

      let html = "";
      myClasses.forEach((c) => {
        const subtitle = `C·∫ßn gia s∆∞ m√¥n ${c.subject} ¬∑ ${c.gradeText}`;
        const classReqs = requests.filter((r) => r.classId === c.id);
        const paidReq = classReqs.find((r) => r.status === "paid");
        const acceptedReq = classReqs.find((r) => r.status === "accepted");

        const applicantsCount = classReqs.length;
        let applicantsHtml = "";
        if (classReqs.length > 0) {
          applicantsHtml = `<div class="applicants-list hidden" data-applicants-for="${c.id}">`;
          classReqs.forEach((req) => {
            const tutor = users.find((u) => u.username === req.tutor);
            const tutorName =
              ((tutor?.lastName || "") + " " + (tutor?.firstName || "")).trim() ||
              req.tutor;
            const firstChar = tutorName[0] || "?";
            const isAccepted = req.status === "accepted";
            const isPaid = req.status === "paid";
            const rowClass = isPaid
              ? "applicant-row applicant-accepted"
              : isAccepted
              ? "applicant-row applicant-accepted"
              : "applicant-row";
            let statusText = "";
            if (req.status === "pending") statusText = " (ƒêang ch·ªù)";
            else if (req.status === "accepted")
              statusText = " (ƒê√£ ch·∫•p nh·∫≠n - ch·ªù gia s∆∞ thanh to√°n)";
            else if (req.status === "rejected") statusText = " (ƒê√£ t·ª´ ch·ªëi)";
            else if (req.status === "paid")
              statusText = " (Gia s∆∞ ƒë√£ thanh to√°n - k·∫øt n·ªëi th√†nh c√¥ng)";

            let actionsHtml = "";
            if (isPaid) {
              actionsHtml = `<span class="status-pill status-connected">ƒê√£ thanh to√°n</span>`;
            } else if (isAccepted) {
              actionsHtml = `
                <button type="button" class="btn btn-outline btn-xs"
                  data-reject-class="${c.id}" data-reject-tutor="${req.tutor}">
                  T·ª´ ch·ªëi
                </button>
              `;
            } else if (req.status === "pending") {
              actionsHtml = `
                <button type="button" class="btn btn-primary btn-xs"
                  data-accept-class="${c.id}" data-accept-tutor="${req.tutor}">
                  Ch·∫•p nh·∫≠n
                </button>
                <button type="button" class="btn btn-outline btn-xs"
                  data-reject-class="${c.id}" data-reject-tutor="${req.tutor}">
                  T·ª´ ch·ªëi
                </button>
              `;
            } else if (req.status === "rejected") {
              actionsHtml = `<span class="status-pill status-rejected">ƒê√£ t·ª´ ch·ªëi</span>`;
            }

            applicantsHtml += `
              <div class="${rowClass}">
                <div class="applicant-left">
                  <div class="applicant-avatar">${firstChar}</div>
                  <div>${tutorName}${statusText}</div>
                </div>
                <div style="display:flex; gap:6px; align-items:center; flex-wrap:wrap;">
                  <button type="button" class="btn btn-outline btn-xs"
                    data-view-tutor="${tutor?.username || req.tutor}">
                    Xem th√¥ng tin
                  </button>
                  ${actionsHtml}
                </div>
              </div>
            `;
          });
          applicantsHtml += `</div>`;
        }

        let footerInfo = "";
        let ratingBlock = "";
        if (paidReq) {
          const tutor = users.find((u) => u.username === paidReq.tutor);
          const name =
            ((tutor?.lastName || "") + " " + (tutor?.firstName || "")).trim() ||
            paidReq.tutor;
          footerInfo = `
            <div style="margin-top:10px; padding:8px 12px; border-radius:8px; background:var(--status-green-bg); color:var(--status-green-text); font-size:13px;">
              ‚úÖ L·ªõp ƒë√£ ƒë∆∞·ª£c k·∫øt n·ªëi th√†nh c√¥ng v·ªõi gia s∆∞: <b>${name}</b>.
            </div>
          `;
          const existingRating = ratings.find(
            (rt) => rt.classId === c.id && rt.tutor === paidReq.tutor
          );
          if (!existingRating) {
            ratingBlock = `
              <div style="margin-top:8px; padding:8px 12px; border-radius:8px; background:#edf2ff; font-size:13px;">
                <div style="margin-bottom:4px;"><b>ƒê√°nh gi√° gia s∆∞</b> (1‚Äì5 sao):</div>
                <div style="display:flex; gap:6px; flex-wrap:wrap; align-items:center; margin-bottom:4px;">
                  <label style="font-size:13px;">S·ªë sao:</label>
                  <select class="select rating-stars" data-rating-class="${c.id}" data-rating-tutor="${paidReq.tutor}" style="width:auto; padding:4px 8px; font-size:13px;">
                    <option value="5">5 ‚≠ê - R·∫•t t·ªët</option>
                    <option value="4">4 ‚≠ê - T·ªët</option>
                    <option value="3">3 ‚≠ê - Kh√°</option>
                    <option value="2">2 ‚≠ê - Trung b√¨nh</option>
                    <option value="1">1 ‚≠ê - Ch∆∞a t·ªët</option>
                  </select>
                </div>
                <textarea class="input rating-comment" data-rating-class="${c.id}" data-rating-tutor="${paidReq.tutor}" rows="2"
                  placeholder="Nh·∫≠n x√©t v·ªÅ gia s∆∞..." style="border-radius:10px;"></textarea>
                <button type="button" class="btn btn-primary btn-xs rating-submit"
                  data-rating-class="${c.id}" data-rating-tutor="${paidReq.tutor}" style="margin-top:6px;">
                  G·ª≠i ƒë√°nh gi√°
                </button>
              </div>
            `;
          } else {
            ratingBlock = `
              <div style="margin-top:8px; padding:8px 12px; border-radius:8px; background:#edf2ff; font-size:13px;">
                <b>B·∫°n ƒë√£ ƒë√°nh gi√° gia s∆∞:</b> ‚≠ê ${existingRating.stars}/5<br/>
                ${existingRating.comment || ""}
              </div>
            `;
          }
        } else if (acceptedReq) {
          const tutor = users.find((u) => u.username === acceptedReq.tutor);
          const name =
            ((tutor?.lastName || "") + " " + (tutor?.firstName || "")).trim() ||
            acceptedReq.tutor;
          footerInfo = `
            <div style="margin-top:10px; padding:8px 12px; border-radius:8px; background:var(--status-wait-bg); color:var(--status-wait-text); font-size:13px;">
              ‚è≥ B·∫°n ƒë√£ ch·ªçn gia s∆∞ <b>${name}</b>. ƒêang ch·ªù gia s∆∞ thanh to√°n ph√≠ nh·∫≠n l·ªõp ƒë·ªÉ ho√†n t·∫•t k·∫øt n·ªëi.
            </div>
          `;
        }

        html += `
          <div class="class-card">
            <div class="class-top-row">
              <div class="avatar-circle">${c.parentName[0]}</div>
              <div class="class-main">
                <div class="class-name">${c.parentName}</div>
                <div class="class-subtitle">${subtitle}</div>

                <div class="class-info-grid">
                  <div class="info-item">
                    <span class="info-icon">üìç</span>
                    <span>${c.address}</span>
                  </div>
                  <div class="info-item">
                    <span class="info-icon">‚è∞</span>
                    <span>Th·ªùi gian h·ªçc: ${c.schedule}</span>
                  </div>
                  <div class="info-item">
                    <span class="info-icon">üí∞</span>
                    <span>M·ª©c l∆∞∆°ng d·ª± ki·∫øn: ${c.fee}</span>
                  </div>
                  <div class="info-item">
                    <span class="info-icon">üéì</span>
                    <span>Y√™u c·∫ßu b·∫±ng c·∫•p: ${c.degreeReq}</span>
                  </div>
                  <div class="info-item">
                    <span class="info-icon">üë•</span>
                    <span>Y√™u c·∫ßu gi·ªõi t√≠nh gia s∆∞: ${c.genderReq}</span>
                  </div>
                  <div class="info-item">
                    <span class="info-icon">üìö</span>
                    <span>M·ª•c ti√™u h·ªçc t·∫≠p: ${c.goal}</span>
                  </div>
                </div>
              </div>
            </div>
            <div class="class-bottom-row">
              <span class="phone-link">${c.phone || "0123456789"}</span>
              <span class="applicants-toggle" data-toggle-applicants="${c.id}">
                üë• Xem gia s∆∞ ·ª©ng tuy·ªÉn (${applicantsCount})
              </span>
            </div>
            ${applicantsHtml}
            ${footerInfo}
            ${ratingBlock}
          </div>
        `;
      });

      container.innerHTML = html;

      // toggle applicants
      container.querySelectorAll("[data-toggle-applicants]").forEach((btn) => {
        btn.addEventListener("click", () => {
          const id = Number(btn.getAttribute("data-toggle-applicants"));
          const list = container.querySelector(
            `.applicants-list[data-applicants-for="${id}"]`
          );
          if (list) list.classList.toggle("hidden");
        });
      });

      // accept tutor
      container.querySelectorAll("[data-accept-class]").forEach((btn) => {
        btn.addEventListener("click", () => {
          const classId = Number(btn.getAttribute("data-accept-class"));
          const tutorUsername = btn.getAttribute("data-accept-tutor");
          requests.forEach((r) => {
            if (r.classId === classId) {
              // ch·ªâ m·ªôt ng∆∞·ªùi ƒë∆∞·ª£c accepted, c√≤n l·∫°i rejected
              r.status = r.tutor === tutorUsername ? "accepted" : "rejected";
            }
          });
          saveRequests(requests);
          alert("ƒê√£ ch·∫•p nh·∫≠n gia s∆∞. ƒêang ch·ªù gia s∆∞ thanh to√°n ph√≠ nh·∫≠n l·ªõp.");
          renderAll();
        });
      });

      // reject tutor
      container.querySelectorAll("[data-reject-class]").forEach((btn) => {
        btn.addEventListener("click", () => {
          const classId = Number(btn.getAttribute("data-reject-class"));
          const tutorUsername = btn.getAttribute("data-reject-tutor");
          requests.forEach((r) => {
            if (r.classId === classId && r.tutor === tutorUsername) {
              r.status = "rejected";
            }
          });
          saveRequests(requests);
          alert("ƒê√£ t·ª´ ch·ªëi gia s∆∞.");
          renderAll();
        });
      });

      // view tutor info
      container.querySelectorAll("[data-view-tutor]").forEach((btn) => {
        btn.addEventListener("click", () => {
          const uname = btn.getAttribute("data-view-tutor");
          const tutor = users.find((u) => u.username === uname);
          if (!tutor) {
            alert("Kh√¥ng t√¨m th·∫•y th√¥ng tin gia s∆∞.");
            return;
          }
          const fullName =
            ((tutor.lastName || "") + " " + (tutor.firstName || "")).trim() ||
            tutor.username;
          alert(
            `Gia s∆∞: ${fullName}\nEmail: ${tutor.email || "Ch∆∞a c·∫≠p nh·∫≠t"}\nSƒêT: ${
              tutor.phone || "Ch∆∞a c·∫≠p nh·∫≠t"
            }`
          );
        });
      });

      // rating submit
      container.querySelectorAll(".rating-submit").forEach((btn) => {
        btn.addEventListener("click", () => {
          const classId = Number(btn.getAttribute("data-rating-class"));
          const tutorUsername = btn.getAttribute("data-rating-tutor");
          const selectEl = container.querySelector(
            `select.rating-stars[data-rating-class="${classId}"][data-rating-tutor="${tutorUsername}"]`
          );
          const commentEl = container.querySelector(
            `textarea.rating-comment[data-rating-class="${classId}"][data-rating-tutor="${tutorUsername}"]`
          );
          if (!selectEl || !commentEl) return;
          const stars = Number(selectEl.value || "5");
          const comment = commentEl.value.trim();
          if (ratings.find((rt) => rt.classId === classId && rt.tutor === tutorUsername)) {
            alert("B·∫°n ƒë√£ ƒë√°nh gi√° gia s∆∞ cho l·ªõp n√†y r·ªìi.");
            return;
          }
          ratings.push({
            classId,
            tutor: tutorUsername,
            stars,
            comment,
            parentName:
              ((currentUser.lastName || "") + " " + (currentUser.firstName || "")).trim() ||
              currentUser.username,
          });
          saveRatings(ratings);
          alert("C·∫£m ∆°n b·∫°n ƒë√£ ƒë√°nh gi√° gia s∆∞!");
          renderAll();
        });
      });
    }

    function renderCreatePostSection() {
      const container = document.getElementById("create-post-content");
      if (!container) return;
      if (!currentUser || currentUser.role !== "phu-huynh") {
        container.innerHTML =
          '<p class="muted">Vui l√≤ng ƒëƒÉng nh·∫≠p v·ªõi vai tr√≤ <b>Ph·ª• huynh</b> ƒë·ªÉ ƒëƒÉng b√†i.</p>';
        return;
      }

      container.innerHTML = `
        <div class="card-form">
          <div class="section-title" style="font-size:22px; margin-bottom:16px;">ƒêƒÇNG B√ÄI T√åM GIA S∆Ø</div>
          <div class="form-group form-grid-2">
            <div>
              <label>M√¥n h·ªçc gia s∆∞ *</label>
              <input id="post-subject" class="input" placeholder="V√≠ d·ª•: To√°n, L√Ω, Anh..." />
            </div>
            <div>
              <label>Th√¥ng tin h·ªçc sinh *</label>
              <input id="post-grade" class="input" placeholder="V√≠ d·ª•: H·ªçc sinh l·ªõp 8" />
            </div>
          </div>
          <div class="form-group">
            <label>ƒê·ªãa ch·ªâ h·ªçc *</label>
            <input id="post-address" class="input" />
          </div>
          <div class="form-group form-grid-2">
            <div>
              <label>Th·ªùi gian h·ªçc *</label>
              <input id="post-schedule" class="input" placeholder="V√≠ d·ª•: Th·ª© hai 2PM - 4PM" />
            </div>
            <div>
              <label>M·ª©c l∆∞∆°ng th√°ng ƒë·∫ßu ti√™n *</label>
              <input id="post-fee" class="input" placeholder="V√≠ d·ª•: 2.000.000 VND" />
            </div>
          </div>
          <div class="form-group form-grid-2">
            <div>
              <label>Y√™u c·∫ßu gi·ªõi t√≠nh gia s∆∞</label>
              <input id="post-gender" class="input" placeholder="Kh√¥ng y√™u c·∫ßu / Nam / N·ªØ..." />
            </div>
            <div>
              <label>Y√™u c·∫ßu tr√¨nh ƒë·ªô/kinh nghi·ªám</label>
              <input id="post-degree" class="input" placeholder="V√≠ d·ª•: T·ªët nghi·ªáp ƒêH S∆∞ ph·∫°m" />
            </div>
          </div>
          <div class="form-group">
            <label>S·ªë ƒëi·ªán tho·∫°i li√™n h·ªá *</label>
            <input id="post-phone" class="input" />
          </div>
          <div class="form-group">
            <label>M·ª•c ti√™u h·ªçc t·∫≠p</label>
            <input id="post-goal" class="input" placeholder="V√≠ d·ª•: C·∫£i thi·ªán ƒëi·ªÉm, √¥n thi..." />
          </div>
          <button id="post-submit" class="btn btn-primary" style="width:100%; margin-top:10px;">
            ‚û§ ƒêƒÇNG B√ÄI NGAY
          </button>
        </div>
      `;
      document.getElementById("post-submit").addEventListener("click", () => {
        const subject = document.getElementById("post-subject").value.trim();
        const gradeText = document.getElementById("post-grade").value.trim();
        const address = document.getElementById("post-address").value.trim();
        const schedule = document.getElementById("post-schedule").value.trim();
        const fee = document.getElementById("post-fee").value.trim();
        const genderReq = document.getElementById("post-gender").value.trim() || "Kh√¥ng y√™u c·∫ßu";
        const degreeReq = document.getElementById("post-degree").value.trim() || "Kh√¥ng y√™u c·∫ßu";
        const phone = document.getElementById("post-phone").value.trim();
        const goal = document.getElementById("post-goal").value.trim() || "C·∫£i thi·ªán ƒëi·ªÉm";

        if (!subject || !gradeText || !address || !schedule || !fee || !phone) {
          alert("Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß c√°c tr∆∞·ªùng b·∫Øt bu·ªôc.");
          return;
        }

        const newId =
          classes.reduce((max, c) => Math.max(max, c.id), 0) + 1;

        const parentName =
          ((currentUser.lastName || "") + " " + (currentUser.firstName || "")).trim() ||
          currentUser.username;

        const newClass = {
          id: newId,
          parentUsername: currentUser.username,
          parentName,
          subject,
          gradeText,
          address,
          schedule,
          fee,
          degreeReq,
          genderReq,
          goal,
          phone,
        };

        classes.push(newClass);
        saveClasses(classes);
        alert("ƒêƒÉng b√†i th√†nh c√¥ng!");
        renderAll();
        showSection("parent-posts-section");
        document
          .querySelectorAll(".nav-page-btn")
          .forEach((b) => b.classList.remove("active"));
        document
          .querySelector('.nav-page-btn[data-target="parent-posts-section"]')
          .classList.add("active");
      });
    }

    /* ===== PAYMENT FEE CALC ===== */
    function computeCommissionText(feeStr) {
      if (!feeStr) return "Kh√¥ng x√°c ƒë·ªãnh";
      const match = feeStr.match(/[\d.,]+/);
      if (!match) return "Kh√¥ng x√°c ƒë·ªãnh t·ª´: " + feeStr;
      let numStr = match[0].replace(/\./g, "").replace(/,/g, ".");
      const base = parseFloat(numStr);
      if (isNaN(base)) return "Kh√¥ng x√°c ƒë·ªãnh t·ª´: " + feeStr;
      const commission = base * 0.25;
      let formatted;
      if (base >= 1000) {
        formatted = commission.toLocaleString("vi-VN");
      } else {
        formatted = commission.toFixed(2);
      }
      const suffix = feeStr.replace(match[0], "").trim();
      return formatted + (suffix ? " " + suffix : "");
    }

    /* PAYMENT CONFIRM */
    document.getElementById("payment-confirm").addEventListener("click", () => {
      if (!paymentTarget) {
        closeModal(paymentModal);
        return;
      }
      const { classId, tutor } = paymentTarget;
      requests.forEach((r) => {
        if (r.classId === classId) {
          if (r.tutor === tutor) r.status = "paid";
          else if (r.status === "accepted") r.status = "rejected";
        }
      });
      saveRequests(requests);
      paymentTarget = null;
      closeModal(paymentModal);
      alert("Thanh to√°n th√†nh c√¥ng! K·∫øt n·ªëi l·ªõp ƒë√£ ho√†n t·∫•t.");
      renderAll();
    });

    /* EDIT PROFILE SAVE */
    document.getElementById("edit-profile-save").addEventListener("click", () => {
      if (!currentUser) return;
      currentUser.lastName = document.getElementById("edit-lastname").value.trim();
      currentUser.firstName = document.getElementById("edit-firstname").value.trim();
      currentUser.phone = document.getElementById("edit-phone").value.trim();
      currentUser.email = document.getElementById("edit-email").value.trim();
      currentUser.edu = document.getElementById("edit-edu").value.trim();
      currentUser.exp = document.getElementById("edit-exp").value.trim();
      currentUser.subject = document.getElementById("edit-subject").value.trim();
      currentUser.gender = document.getElementById("edit-gender").value;
      currentUser.achievements = document.getElementById("edit-achievements").value.trim();

      const idx = users.findIndex((u) => u.username === currentUser.username);
      if (idx >= 0) {
        users[idx] = currentUser;
        saveUsers(users);
        saveCurrentUser(currentUser);
      }
      closeModal(editProfileModal);
      alert("ƒê√£ l∆∞u th√¥ng tin h·ªì s∆°.");
      renderAll();
    });

    /* ===== QUIZ RENDER ===== */
    function renderTestSection() {
      const container = document.getElementById("test-section-content");
      if (!container) return;

      if (!currentUser || currentUser.role !== "gia-su") {
        container.innerHTML =
          '<p class="muted">Ch·ª©c nƒÉng n√†y ch·ªâ d√†nh cho t√†i kho·∫£n <b>Gia s∆∞</b>. Vui l√≤ng ƒëƒÉng nh·∫≠p.</p>';
        return;
      }

      const statusText = currentUser.tutorVerified
        ? "ƒê√É X√ÅC TH·ª∞C (b·∫°n c√≥ th·ªÉ nh·∫≠n l·ªõp)"
        : "CH∆ØA X√ÅC TH·ª∞C (c·∫ßn ƒë·∫°t ‚â• 8/10 c√¢u ƒë√∫ng)";

      container.innerHTML = `
        <div class="quiz-card">
          <p class="quiz-status">Tr·∫°ng th√°i t√†i kho·∫£n gia s∆∞: <b>${statusText}</b></p>
          <p class="quiz-note">
            Ch·ªçn m√¥n mu·ªën d·∫°y v√† l√†m <b>10 c√¢u tr·∫Øc nghi·ªám</b>. ƒêi·ªÉm ƒë·∫°t: <b>8/10</b>.
            B·∫°n c√≥ th·ªÉ l√†m l·∫°i nhi·ªÅu l·∫ßn n·∫øu ch∆∞a ƒë·∫°t.
          </p>
          <div class="form-group">
            <label>M√¥n mu·ªën d·∫°y *</label>
            <select id="quiz-subject" class="select">
              <option value="math">To√°n</option>
              <option value="physics">V·∫≠t l√Ω</option>
              <option value="chemistry">H√≥a h·ªçc</option>
              <option value="literature">Ng·ªØ vƒÉn</option>
              <option value="english">Ti·∫øng Anh</option>
              <option value="biology">Sinh h·ªçc</option>
              <option value="history">L·ªãch s·ª≠</option>
              <option value="geography">ƒê·ªãa l√Ω</option>
            </select>
          </div>
          <button id="quiz-start" class="btn btn-primary">B·∫Øt ƒë·∫ßu l√†m b√†i</button>
          <div id="quiz-questions-container" style="margin-top:16px;"></div>
        </div>
      `;

      document.getElementById("quiz-start").addEventListener("click", () => {
        const subject = document.getElementById("quiz-subject").value;
        const qs = QUIZ_QUESTIONS[subject] || [];
        const qc = document.getElementById("quiz-questions-container");
        if (!qs.length) {
          qc.innerHTML = "<p>Ch∆∞a c√≥ c√¢u h·ªèi cho m√¥n n√†y.</p>";
          return;
        }
        let html = `<form id="quiz-form">`;
        qs.forEach((item, idx) => {
          html += `
            <div class="quiz-question">
              <div class="quiz-question-title">C√¢u ${idx + 1}: ${item.q}</div>
              <div class="quiz-options">
                ${item.o
                  .map(
                    (opt, oi) => `
                  <label>
                    <input type="radio" name="q${idx}" value="${oi}" style="margin-right:4px;" />
                    ${opt}
                  </label>
                `
                  )
                  .join("")}
              </div>
            </div>
          `;
        });
        html += `
          <button type="submit" class="btn btn-primary" style="margin-top:8px;">
            N·ªôp b√†i
          </button>
        </form>
        `;
        qc.innerHTML = html;

        document
          .getElementById("quiz-form")
          .addEventListener("submit", (e) => {
            e.preventDefault();
            let correct = 0;
            qs.forEach((item, idx) => {
              const chosen = document.querySelector(
                `input[name="q${idx}"]:checked`
              );
              if (chosen && Number(chosen.value) === item.a) correct++;
            });
            alert(`B·∫°n l√†m ƒë√∫ng ${correct}/${qs.length} c√¢u.`);
            if (correct >= 8) {
              alert("Ch√∫c m·ª´ng! B·∫°n ƒë√£ v∆∞·ª£t qua b√†i ki·ªÉm tra nƒÉng l·ª±c gia s∆∞.");
              currentUser.tutorVerified = true;
              const idxUser = users.findIndex(
                (u) => u.username === currentUser.username
              );
              if (idxUser >= 0) {
                users[idxUser] = currentUser;
                saveUsers(users);
                saveCurrentUser(currentUser);
              }
              updateAuthUI();
              showSection("tutor-section");
              document
                .querySelectorAll(".nav-page-btn")
                .forEach((b) => b.classList.remove("active"));
              document
                .querySelector('.nav-page-btn[data-target="tutor-section"]')
                .classList.add("active");
            } else {
              alert(
                "B·∫°n ch∆∞a ƒë·∫°t 8/10. H√£y xem l·∫°i ƒë√°p √°n v√† th·ª≠ l·∫°i b√†i ki·ªÉm tra."
              );
            }
          });
      });
    }

    function renderAll() {
      renderClassesList();
      renderTutorSection();
      renderParentPosts();
      renderCreatePostSection();
      renderTestSection();
    }

    /* INIT */
    updateAuthUI(); // c≈©ng g·ªçi renderAll b√™n trong
  </script>
</body>
</html>
